(()=>{"use strict";var __webpack_modules__={580:(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{eval('\n;// ./src/assets/images/background-image.jpg\nconst background_image_namespaceObject = __webpack_require__.p + "assets/b433f9d3f3d21c4d77cd.jpg";\n;// ./src/modules/Header.js\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar Header = /*#__PURE__*/function () {\n  function Header() {\n    _classCallCheck(this, Header);\n  }\n  _createClass(Header, [{\n    key: "renderHeader",\n    value:\n    // DOM methods\n    function renderHeader(location) {\n      var header = document.createElement(\'header\');\n      header.innerHTML = "\\n      <div class=\\"bg-image\\" style=\\"background-image: url(".concat(background_image_namespaceObject, ")\\"></div>\\n      <h1>Build Your Reading List</h1>\\n    ");\n      document.querySelector(location).appendChild(header);\n    }\n  }]);\n  return Header;\n}();\n/* harmony default export */ const modules_Header = (Header);\n;// ./src/modules/Footer.js\nfunction Footer_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\nfunction Footer_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\nfunction Footer_createClass(Constructor, protoProps, staticProps) { if (protoProps) Footer_defineProperties(Constructor.prototype, protoProps); if (staticProps) Footer_defineProperties(Constructor, staticProps); return Constructor; }\nvar Footer = /*#__PURE__*/function () {\n  function Footer() {\n    Footer_classCallCheck(this, Footer);\n  }\n  Footer_createClass(Footer, [{\n    key: "renderFooter",\n    value:\n    // DOM methods\n    function renderFooter(location) {\n      var footer = document.createElement(\'footer\');\n      footer.innerHTML = "Created by <a href=\\"https://autumnchris.github.io/portfolio\\" target=\\"_blank\\">Autumn Bullard</a> &copy; ".concat(new Date().getFullYear());\n      document.querySelector(location).appendChild(footer);\n    }\n  }]);\n  return Footer;\n}();\n/* harmony default export */ const modules_Footer = (Footer);\n;// ./src/utils/getLocalStorage.js\nfunction getLocalStorage(key) {\n  return JSON.parse(localStorage.getItem(key));\n}\n;// ./src/utils/setToLocalStorage.js\nfunction setToLocalStorage(key, value) {\n  localStorage.setItem(key, JSON.stringify(value));\n}\n;// ./src/utils/getReadingList.js\n\n\nfunction getReadingList(value) {\n  if (value) setToLocalStorage(\'readingList\', value);\n  return getLocalStorage(\'readingList\') || [];\n}\n;// ./src/modules/Sidebar.js\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _iterableToArray(iter) { if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null) return Array.from(iter); }\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\nfunction Sidebar_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\nfunction Sidebar_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\nfunction Sidebar_createClass(Constructor, protoProps, staticProps) { if (protoProps) Sidebar_defineProperties(Constructor.prototype, protoProps); if (staticProps) Sidebar_defineProperties(Constructor, staticProps); return Constructor; }\n\nvar Sidebar = /*#__PURE__*/function () {\n  function Sidebar() {\n    Sidebar_classCallCheck(this, Sidebar);\n  }\n  Sidebar_createClass(Sidebar, [{\n    key: "renderReadingListStats",\n    value:\n    // DOM methods\n    function renderReadingListStats(location) {\n      var readingListStats = document.createElement(\'div\');\n      readingListStats.classList.add(\'reading-list-stats\');\n      readingListStats.innerHTML = "\\n      <div class=\\"stat\\"><span class=\\"stat-label\\">Books</span> ".concat(_toConsumableArray(getReadingList()).length, "</div>\\n      <div class=\\"stat\\"><span class=\\"stat-label\\">Read</span> ").concat(_toConsumableArray(getReadingList()).filter(function (book) {\n        return book.read;\n      }).length, "</div>\\n      <div class=\\"stat\\"><span class=\\"stat-label\\">Unread</span> ").concat(_toConsumableArray(getReadingList()).filter(function (book) {\n        return !book.read;\n      }).length, "</div>\\n    ");\n      document.querySelector(location).appendChild(readingListStats);\n    }\n  }, {\n    key: "removeReadingListStats",\n    value: function removeReadingListStats(location) {\n      var readingListStats = document.querySelector("".concat(location, " .reading-list-stats"));\n      readingListStats ? document.querySelector(location).removeChild(readingListStats) : null;\n    }\n  }, {\n    key: "renderSidebar",\n    value: function renderSidebar(location) {\n      var sidebar = document.createElement(\'aside\');\n      sidebar.classList.add(\'col\', \'sidebar\');\n      sidebar.innerHTML = "\\n      <div class=\\"button-group\\">\\n        <button type=\\"button\\" class=\\"button add-book-button\\"><span class=\\"icon fa-solid fa-plus\\" aria-hidden=\\"true\\"></span> Add Book</button>\\n      </div>\\n    ";\n      document.querySelector(location).appendChild(sidebar);\n      this.renderReadingListStats(\'.sidebar\');\n    }\n  }]);\n  return Sidebar;\n}();\n/* harmony default export */ const modules_Sidebar = (Sidebar);\n;// ./src/modules/InfoMessage.js\nfunction InfoMessage_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\nfunction InfoMessage_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\nfunction InfoMessage_createClass(Constructor, protoProps, staticProps) { if (protoProps) InfoMessage_defineProperties(Constructor.prototype, protoProps); if (staticProps) InfoMessage_defineProperties(Constructor, staticProps); return Constructor; }\nvar InfoMessage = /*#__PURE__*/function () {\n  function InfoMessage() {\n    InfoMessage_classCallCheck(this, InfoMessage);\n  }\n  InfoMessage_createClass(InfoMessage, [{\n    key: "renderInfoMessage",\n    value:\n    // DOM methods\n    function renderInfoMessage(message, location) {\n      var infoMessage = document.createElement(\'p\');\n      infoMessage.classList.add(\'message\', \'info-message\');\n      infoMessage.innerHTML = "<span class=\\"fa-solid fa-circle-info fa-lg fa-fw\\" aria-hidden=\\"true\\"></span> ".concat(message);\n      document.querySelector(location).appendChild(infoMessage);\n    }\n  }, {\n    key: "removeInfoMessage",\n    value: function removeInfoMessage(location) {\n      var infoMessage = document.querySelector("".concat(location, " .info-message"));\n      infoMessage ? document.querySelector(location).removeChild(infoMessage) : null;\n    }\n  }]);\n  return InfoMessage;\n}();\n/* harmony default export */ const modules_InfoMessage = (InfoMessage);\n;// ./src/modules/FilterSortForm.js\nfunction FilterSortForm_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\nfunction FilterSortForm_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\nfunction FilterSortForm_createClass(Constructor, protoProps, staticProps) { if (protoProps) FilterSortForm_defineProperties(Constructor.prototype, protoProps); if (staticProps) FilterSortForm_defineProperties(Constructor, staticProps); return Constructor; }\nvar FilterSortForm = /*#__PURE__*/function () {\n  function FilterSortForm() {\n    FilterSortForm_classCallCheck(this, FilterSortForm);\n  }\n  FilterSortForm_createClass(FilterSortForm, [{\n    key: "renderFilterSortForm",\n    value:\n    // DOM methods\n    function renderFilterSortForm(location, filterSortFormData) {\n      var filterSortForm = document.createElement(\'form\');\n      filterSortForm.classList.add(\'filter-sort-form\');\n      filterSortForm.setAttribute(\'novalidate\', \'true\');\n      filterSortForm.innerHTML = "\\n      <div class=\\"row row-search\\">\\n        <div class=\\"form-group\\">\\n          <label for=\\"search-value\\">Filter by Keyword</label>\\n          <input type=\\"text\\" name=\\"searchValue\\" class=\\"search-value\\" value=\\"".concat(filterSortFormData.searchValue, "\\" placeholder=\\"Find a book...\\" id=\\"search-value\\" autoComplete=\\"off\\" autocapitalize=\\"off\\" />\\n        </div>\\n      </div>\\n      <div class=\\"row row-select\\">\\n        <div class=\\"form-group\\">\\n          <label for=\\"filter-read-value\\">Filter by Read Status</label>\\n          <div class=\\"select-wrapper\\">\\n            <select name=\\"filterReadValue\\" id=\\"filter-read-value\\" autoComplete=\\"off\\">\\n              <option value=\\"all\\" ").concat(filterSortFormData.filterReadValue === \'all\' ? \'selected\' : \'\', ">All</option>\\n              <option value=\\"read\\" ").concat(filterSortFormData.filterReadValue === \'read\' ? \'selected\' : \'\', ">Read</option>\\n              <option value=\\"unread\\" ").concat(filterSortFormData.filterReadValue === \'unread\' ? \'selected\' : \'\', ">Unread</option>\\n            </select>\\n          </div>\\n        </div>\\n        <div class=\\"form-group\\">\\n          <label for=\\"sort-value\\">Order by</label>\\n          <div class=\\"select-wrapper\\">\\n            <select name=\\"sortValue\\" id=\\"sort-value\\" autoComplete=\\"off\\">\\n              <option value=\\"title\\" ").concat(filterSortFormData.sortValue === \'title\' ? \'selected\' : \'\', ">Title</option>\\n              <option value=\\"first-name\\" ").concat(filterSortFormData.sortValue === \'first-name\' ? \'selected\' : \'\', ">Author: First Name</option>\\n              <option value=\\"last-name\\" ").concat(filterSortFormData.sortValue === \'last-name\' ? \'selected\' : \'\', ">Author: Last Name</option>\\n              <option value=\\"pages-least\\" ").concat(filterSortFormData.sortValue === \'pages-least\' ? \'selected\' : \'\', ">Pages: Least to Greatest</option>\\n              <option value=\\"pages-greatest\\" ").concat(filterSortFormData.sortValue === \'pages-greatest\' ? \'selected\' : \'\', ">Pages: Greatest to Least</option>\\n            </select>\\n          </div>\\n        </div>\\n      </div>\\n    ");\n      document.querySelector(location).appendChild(filterSortForm);\n    }\n  }]);\n  return FilterSortForm;\n}();\n/* harmony default export */ const modules_FilterSortForm = (FilterSortForm);\n;// ./src/modules/ReadingList.js\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction ReadingList_toConsumableArray(arr) { return ReadingList_arrayWithoutHoles(arr) || ReadingList_iterableToArray(arr) || ReadingList_unsupportedIterableToArray(arr) || ReadingList_nonIterableSpread(); }\nfunction ReadingList_nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }\nfunction ReadingList_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return ReadingList_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return ReadingList_arrayLikeToArray(o, minLen); }\nfunction ReadingList_iterableToArray(iter) { if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null) return Array.from(iter); }\nfunction ReadingList_arrayWithoutHoles(arr) { if (Array.isArray(arr)) return ReadingList_arrayLikeToArray(arr); }\nfunction ReadingList_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\nfunction ReadingList_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\nfunction ReadingList_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\nfunction ReadingList_createClass(Constructor, protoProps, staticProps) { if (protoProps) ReadingList_defineProperties(Constructor.prototype, protoProps); if (staticProps) ReadingList_defineProperties(Constructor, staticProps); return Constructor; }\n\n\n\nvar ReadingList = /*#__PURE__*/function () {\n  function ReadingList(sidebarInstance) {\n    ReadingList_classCallCheck(this, ReadingList);\n    this.infoMessage = new modules_InfoMessage();\n    this.sidebar = sidebarInstance;\n    this.filterSortForm = new modules_FilterSortForm();\n    this.viewableReadingList = ReadingList_toConsumableArray(getReadingList());\n    this.filterSortFormData = {\n      searchValue: \'\',\n      filterReadValue: \'all\',\n      sortValue: \'title\'\n    };\n    this.editBookFormData = {\n      title: \'\',\n      author: \'\',\n      pages: \'\',\n      read: false,\n      id: null\n    };\n  }\n\n  // Update filterSortFormData variable when the Filter/Sort form inputs change\n  ReadingList_createClass(ReadingList, [{\n    key: "handleChange",\n    value: function handleChange(event) {\n      this.filterSortFormData = _objectSpread(_objectSpread({}, this.filterSortFormData), {}, _defineProperty({}, event.target.name, event.target.value));\n      this.updateViewableReadingList();\n    }\n\n    // Update viewable reading list based on Filter/Sort form inputs\n  }, {\n    key: "updateViewableReadingList",\n    value: function updateViewableReadingList() {\n      if (document.querySelector(\'.filter-sort-form\')) {\n        this.filterSortFormData.searchValue = document.getElementById(\'search-value\').value;\n        this.filterSortFormData.filterReadValue = document.getElementById(\'filter-read-value\').value;\n        this.filterSortFormData.sortValue = document.getElementById(\'sort-value\').value;\n      }\n      var viewableReadingListData = ReadingList_toConsumableArray(getReadingList());\n      viewableReadingListData = this.searchReadingList(this.filterSortFormData.searchValue, viewableReadingListData);\n      viewableReadingListData = this.filterByReadStatus(this.filterSortFormData.filterReadValue, viewableReadingListData);\n      viewableReadingListData = this.sortBooks(this.filterSortFormData.sortValue, viewableReadingListData);\n      this.viewableReadingList = viewableReadingListData;\n      if (ReadingList_toConsumableArray(getReadingList()).length === 0) {\n        this.removeReadingListContent(\'.reading-list-container\');\n        this.renderReadingListContent(ReadingList_toConsumableArray(getReadingList()), \'.reading-list-container\');\n      } else {\n        this.removeReadingList(\'.reading-list-content\');\n        this.renderReadingList(viewableReadingListData, \'.reading-list-content\');\n      }\n    }\n\n    // Filter viewable reading list by search input\n  }, {\n    key: "searchReadingList",\n    value: function searchReadingList(value, viewableReadingListData) {\n      value = value.toLowerCase();\n      if (value) {\n        return viewableReadingListData.filter(function (book) {\n          return book.title.toLowerCase().includes(value) || book.author.toLowerCase().includes(value);\n        });\n      } else {\n        return viewableReadingListData;\n      }\n    }\n\n    // Filter viewable reading list by Read status\n  }, {\n    key: "filterByReadStatus",\n    value: function filterByReadStatus(value, viewableReadingListData) {\n      viewableReadingListData = viewableReadingListData.filter(function (book) {\n        if (value === \'read\') {\n          return book.read;\n        } else if (value === \'unread\') {\n          return !book.read;\n        } else {\n          return book;\n        }\n      });\n      return viewableReadingListData;\n    }\n\n    // Sort viewable reading list\n  }, {\n    key: "sortBooks",\n    value: function sortBooks(value, viewableReadingListData) {\n      viewableReadingListData = viewableReadingListData.sort(function (a, b) {\n        var authorNameA = a.author.toLowerCase().split(\' \');\n        var authorNameB = b.author.toLowerCase().split(\' \');\n        var lastNameA = authorNameA[authorNameA.length - 1];\n        var lastNameB = authorNameB[authorNameB.length - 1];\n        var firstNameA = authorNameA[0];\n        var firstNameB = authorNameB[0];\n        switch (value) {\n          case \'title\':\n            return a.title.toLowerCase().localeCompare(b.title.toLowerCase());\n          case \'first-name\':\n            if (lastNameA === lastNameB && firstNameA === firstNameB && authorNameA.length > authorNameB.length) {\n              return authorNameB.join(\' \').localeCompare(authorNameA.join(\' \'));\n            } else {\n              return authorNameA.join(\' \').localeCompare(authorNameB.join(\' \'));\n            }\n          case \'last-name\':\n            if (lastNameA === lastNameB) {\n              authorNameA.pop();\n              authorNameB.pop();\n              return authorNameA.join(\' \').localeCompare(authorNameB.join(\' \'));\n            } else {\n              return lastNameA.localeCompare(lastNameB);\n            }\n          case \'pages-least\':\n            return a.pages - b.pages;\n          case \'pages-greatest\':\n            return b.pages - a.pages;\n        }\n      });\n      return viewableReadingListData;\n    }\n\n    // Add a new book to the reading list\n  }, {\n    key: "addNewBook",\n    value: function addNewBook(newBook, readingListData) {\n      var wasEmpty = readingListData.length === 0;\n      readingListData.push(newBook);\n      getReadingList(readingListData);\n      if (wasEmpty) {\n        this.filterSortForm.renderFilterSortForm(\'.reading-list-content\', this.filterSortFormData);\n      }\n      this.updateViewableReadingList();\n      this.sidebar.removeReadingListStats(\'.sidebar\');\n      this.sidebar.renderReadingListStats(\'.sidebar\');\n    }\n\n    // Edit a book in the reading list\n  }, {\n    key: "editBook",\n    value: function editBook(editBookFormData, bookID, readingListData) {\n      readingListData = readingListData.map(function (book) {\n        if (book.id === Number(bookID)) {\n          return _objectSpread(_objectSpread({}, book), {}, {\n            title: editBookFormData.title,\n            author: editBookFormData.author,\n            pages: editBookFormData.pages,\n            read: editBookFormData.read\n          });\n        } else {\n          return book;\n        }\n      });\n      getReadingList(readingListData);\n      this.updateViewableReadingList();\n      this.sidebar.removeReadingListStats(\'.sidebar\');\n      this.sidebar.renderReadingListStats(\'.sidebar\');\n    }\n\n    // Delete a book from the reading list\n  }, {\n    key: "deleteBook",\n    value: function deleteBook(readingListData, bookID) {\n      if (confirm(\'Are you sure you want to remove this book from your reading list?\')) {\n        readingListData = readingListData.filter(function (book) {\n          return book.id !== Number(bookID);\n        });\n        getReadingList(readingListData);\n        this.updateViewableReadingList();\n        this.sidebar.removeReadingListStats(\'.sidebar\');\n        this.sidebar.renderReadingListStats(\'.sidebar\');\n      }\n    }\n\n    // Toggle a book\'s read status in the reading list\n  }, {\n    key: "toggleRead",\n    value: function toggleRead(event, bookID, readingListData) {\n      if (event.type === \'click\' && !event.target.matches(\'input[type=checkbox]\')) return;\n      if (event.key === \'Enter\' || event.key === \' \') {\n        event.preventDefault();\n        document.getElementById("read-".concat(bookID)).checked = !document.getElementById("read-".concat(bookID)).checked;\n      }\n      if (event.key === \'Enter\' || event.key === \' \' || event.type === \'click\') {\n        readingListData = readingListData.map(function (book) {\n          if (book.id === Number(bookID)) {\n            return _objectSpread(_objectSpread({}, book), {}, {\n              read: !book.read\n            });\n          }\n          return book;\n        });\n        getReadingList(readingListData);\n        this.updateViewableReadingList();\n        this.sidebar.removeReadingListStats(\'.sidebar\');\n        this.sidebar.renderReadingListStats(\'.sidebar\');\n      }\n    }\n\n    // DOM methods\n  }, {\n    key: "renderBooks",\n    value: function renderBooks(readingListData) {\n      var readingList = document.querySelector(\'.reading-list\');\n      readingList.innerHTML = readingListData.map(function (book) {\n        return "\\n        <div class=\\"book-card\\">\\n          <div class=\\"row\\">\\n            <div class=\\"title\\">".concat(book.title, "</div>\\n            <div class=\\"button-group\\">\\n              <button type=\\"button\\" class=\\"button edit-book-button\\" data-id=\\"").concat(book.id, "\\" aria-label=\\"edit book ").concat(book.title, " by ").concat(book.author, "\\" title=\\"Edit\\">\\n                <span class=\\"fa-solid fa-pencil fa-sm fa-fw icon\\"></span>\\n              </button>\\n              <button type=\\"button\\" class=\\"button delete-book-button\\" data-id=\\"").concat(book.id, "\\" aria-label=\\"delete book ").concat(book.title, " by ").concat(book.author, "\\" title=\\"Delete\\">\\n                <span class=\\"fa-solid fa-trash fa-sm icon\\"></span>\\n              </button>\\n            </div>\\n          </div>\\n          <div class=\\"row\\">\\n            <div class=\\"book-info author\\"><span class=\\"book-info-label\\">by </span>").concat(book.author, "</div>\\n            <div class=\\"book-info pages\\"><span class=\\"book-info-label\\">Pages </span>").concat(book.pages, "</div>\\n            <form novalidate>\\n              <div class=\\"form-group\\">\\n                <label class=\\"check-label\\" for=\\"read-").concat(book.id, "\\">Read\\n                  <input type=\\"checkbox\\" name=\\"readValue\\" tabindex=\\"-1\\" data-id=\\"").concat(book.id, "\\" id=\\"read-").concat(book.id, "\\" autocomplete=\\"off\\" ").concat(book.read ? \'checked\' : \'\', " />\\n                  <span class=\\"checkmark\\" tabindex=\\"0\\" data-id=\\"").concat(book.id, "\\"></span>\\n                </label>\\n              </div>\\n            </form>\\n          </div>\\n        </div>\\n      ");\n      }).join(\'\');\n    }\n  }, {\n    key: "renderReadingList",\n    value: function renderReadingList(readingListData, location) {\n      var readingList = document.createElement(\'div\');\n      readingList.classList.add(\'reading-list\');\n      document.querySelector(location).appendChild(readingList);\n      this.infoMessage.removeInfoMessage(\'.reading-list-content\');\n      if (readingListData.length === 0) {\n        this.infoMessage.renderInfoMessage(\'No results match your search specifications.\', \'.reading-list-content\');\n      } else {\n        this.infoMessage.removeInfoMessage(\'.reading-list-content\');\n        this.renderBooks(readingListData);\n      }\n    }\n  }, {\n    key: "removeReadingList",\n    value: function removeReadingList(location) {\n      var readingList = document.querySelector("".concat(location, " .reading-list"));\n      readingList ? document.querySelector(location).removeChild(readingList) : null;\n    }\n  }, {\n    key: "renderReadingListContent",\n    value: function renderReadingListContent(readingListData, location) {\n      var readingListContent = document.createElement(\'div\');\n      readingListContent.classList.add(\'col\', \'reading-list-content\');\n      document.querySelector(location).appendChild(readingListContent);\n      if (readingListData.length === 0) {\n        this.infoMessage.renderInfoMessage(\'You currently have no books in your reading list. Click the Add Book button to get started.\', \'.reading-list-content\');\n      } else {\n        this.filterSortForm.renderFilterSortForm(\'.reading-list-content\', this.filterSortFormData);\n        this.updateViewableReadingList();\n      }\n    }\n  }, {\n    key: "removeReadingListContent",\n    value: function removeReadingListContent(location) {\n      var readingListContent = document.querySelector("".concat(location, " .reading-list-content"));\n      readingListContent ? document.querySelector(location).removeChild(readingListContent) : null;\n    }\n  }]);\n  return ReadingList;\n}();\n/* harmony default export */ const modules_ReadingList = (ReadingList);\n;// ./src/modules/ErrorMessage.js\nfunction ErrorMessage_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\nfunction ErrorMessage_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\nfunction ErrorMessage_createClass(Constructor, protoProps, staticProps) { if (protoProps) ErrorMessage_defineProperties(Constructor.prototype, protoProps); if (staticProps) ErrorMessage_defineProperties(Constructor, staticProps); return Constructor; }\nvar ErrorMessage = /*#__PURE__*/function () {\n  function ErrorMessage() {\n    ErrorMessage_classCallCheck(this, ErrorMessage);\n  }\n  ErrorMessage_createClass(ErrorMessage, [{\n    key: "renderErrorMessage",\n    value:\n    // DOM methods\n    function renderErrorMessage(message, location) {\n      var errorMessage = document.createElement(\'p\');\n      errorMessage.classList.add(\'message\', \'error-message\');\n      errorMessage.innerHTML = "<span class=\\"fa-solid fa-circle-exclamation fa-lg fa-fw\\" aria-hidden=\\"true\\"></span> ".concat(message);\n      document.querySelector(location).appendChild(errorMessage);\n    }\n  }, {\n    key: "removeErrorMessage",\n    value: function removeErrorMessage(location) {\n      var errorMessage = document.querySelector("".concat(location, " .error-message"));\n      errorMessage ? document.querySelector(location).removeChild(errorMessage) : null;\n    }\n  }]);\n  return ErrorMessage;\n}();\n/* harmony default export */ const modules_ErrorMessage = (ErrorMessage);\n;// ./src/modules/Book.js\nfunction Book_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\nvar Book = function Book(title, author, pages, read, bookID) {\n  Book_classCallCheck(this, Book);\n  this.title = title;\n  this.author = author;\n  this.pages = pages;\n  this.read = read;\n  this.id = bookID;\n};\n/* harmony default export */ const modules_Book = (Book);\n;// ./src/modules/BookFormModal.js\nfunction BookFormModal_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\nfunction BookFormModal_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { BookFormModal_ownKeys(Object(source), true).forEach(function (key) { BookFormModal_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { BookFormModal_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nfunction BookFormModal_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction BookFormModal_toConsumableArray(arr) { return BookFormModal_arrayWithoutHoles(arr) || BookFormModal_iterableToArray(arr) || BookFormModal_unsupportedIterableToArray(arr) || BookFormModal_nonIterableSpread(); }\nfunction BookFormModal_nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }\nfunction BookFormModal_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return BookFormModal_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return BookFormModal_arrayLikeToArray(o, minLen); }\nfunction BookFormModal_iterableToArray(iter) { if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null) return Array.from(iter); }\nfunction BookFormModal_arrayWithoutHoles(arr) { if (Array.isArray(arr)) return BookFormModal_arrayLikeToArray(arr); }\nfunction BookFormModal_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\nfunction BookFormModal_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\nfunction BookFormModal_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\nfunction BookFormModal_createClass(Constructor, protoProps, staticProps) { if (protoProps) BookFormModal_defineProperties(Constructor.prototype, protoProps); if (staticProps) BookFormModal_defineProperties(Constructor, staticProps); return Constructor; }\n\n\n\nvar BookFormModal = /*#__PURE__*/function () {\n  function BookFormModal(readingListInstance) {\n    BookFormModal_classCallCheck(this, BookFormModal);\n    this.errorMessage = new modules_ErrorMessage();\n    this.readingList = readingListInstance;\n    this.bookFormType = null;\n    this.currentBookID = null;\n    this.formValues = {\n      title: \'\',\n      author: \'\',\n      pages: \'\',\n      read: false\n    };\n  }\n\n  // Toggle a book\'s Read status in the Book Form Modal with keyboard\n  BookFormModal_createClass(BookFormModal, [{\n    key: "handleKeyDown",\n    value: function handleKeyDown(event) {\n      if (event.key === \'Enter\' || event.key === \' \') {\n        event.preventDefault();\n        document.getElementById(event.target.dataset.inputId).checked = !document.getElementById(event.target.dataset.inputId).checked;\n        this.formValues.read = document.getElementById(event.target.dataset.inputId).checked;\n      }\n    }\n\n    // Save a book in form modal\n  }, {\n    key: "handleSubmit",\n    value: function handleSubmit(event, formValues) {\n      event.preventDefault();\n      this.errorMessage.removeErrorMessage(\'#modal .modal-body\');\n      formValues.title = formValues.title.trim();\n      formValues.author = formValues.author.trim();\n      formValues.pages = formValues.pages.trim();\n      if (!formValues.title) {\n        this.errorMessage.renderErrorMessage(\'A book title is required to add a new book.\', \'#modal .modal-body\');\n      } else if (!formValues.author) {\n        this.errorMessage.renderErrorMessage(\'An author is required to add a new book.\', \'#modal .modal-body\');\n      } else if (!formValues.pages) {\n        this.errorMessage.renderErrorMessage(\'The number of pages is required to add a new book.\', \'#modal .modal-body\');\n      } else if (isNaN(formValues.pages) || formValues.pages <= 0) {\n        this.errorMessage.renderErrorMessage(\'The number of pages must be a number greater than 0.\', \'#modal .modal-body\');\n      } else {\n        if (this.bookFormType === \'edit\') {\n          this.editBook(formValues, BookFormModal_toConsumableArray(getReadingList()));\n        } else {\n          this.addNewBook(formValues, BookFormModal_toConsumableArray(getReadingList()));\n        }\n        this.closeModal();\n      }\n    }\n\n    // Add a new book to the reading list\n  }, {\n    key: "addNewBook",\n    value: function addNewBook(formValues, readingListData) {\n      var newBook = new modules_Book(formValues.title, formValues.author, formValues.pages, formValues.read, Date.now());\n      this.readingList.addNewBook(newBook, readingListData);\n    }\n\n    // Edit a book in the reading list\n  }, {\n    key: "editBook",\n    value: function editBook(formValues, readingListData) {\n      this.readingList.editBook(formValues, this.currentBookID, readingListData);\n    }\n\n    // Open book form modal\n  }, {\n    key: "openModal",\n    value: function openModal(bookFormType) {\n      var readingListData = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      var bookID = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      var bookToBeEdited;\n      var formData;\n      if (bookFormType === \'edit\') {\n        this.bookFormType = \'edit\';\n        this.currentBookID = bookID;\n        bookToBeEdited = readingListData.find(function (book) {\n          return book.id === Number(bookID);\n        });\n        formData = {\n          title: bookToBeEdited.title,\n          author: bookToBeEdited.author,\n          pages: bookToBeEdited.pages,\n          read: bookToBeEdited.read\n        };\n      } else {\n        this.bookFormType = \'add\';\n        formData = this.formValues;\n      }\n      this.renderBookFormModal(\'main\', formData);\n    }\n\n    // Close book form modal\n  }, {\n    key: "closeModal",\n    value: function closeModal() {\n      this.removeBookFormModal(\'main\');\n      this.formValues = BookFormModal_objectSpread(BookFormModal_objectSpread({}, this.formValues), {}, {\n        title: \'\',\n        author: \'\',\n        pages: \'\',\n        read: false\n      });\n      this.currentBookID = null;\n    }\n\n    // DOM methods\n  }, {\n    key: "renderBookFormModal",\n    value: function renderBookFormModal(location, formData) {\n      var bookFormModal = document.createElement(\'div\');\n      bookFormModal.setAttribute(\'id\', \'modal\');\n      bookFormModal.classList.add(\'modal\');\n      bookFormModal.innerHTML = "\\n      <div class=\\"modal-content\\">\\n        <div class=\\"modal-header\\">".concat(this.bookFormType === \'edit\' ? \'Edit\' : \'Add New\', " Book</div>\\n        <div class=\\"modal-body\\">\\n          <form class=\\"new-book-form\\" novalidate>\\n            <div class=\\"form-group\\">\\n              <label for=\\"title-value\\">Title</label>\\n              <input type=\\"text\\" class=\\"title-value\\" name=\\"title\\" value=\\"").concat(formData.title, "\\" id=\\"title-value\\" autocomplete=\\"off\\" required />\\n            </div>\\n            <div class=\\"form-group\\">\\n              <label for=\\"author-value\\">Author</label>\\n              <input type=\\"text\\" class=\\"author-value\\" name=\\"author\\" value=\\"").concat(formData.author, "\\" id=\\"author-value\\" autocomplete=\\"off\\" required />\\n            </div>\\n            <div class=\\"form-group\\">\\n              <label for=\\"pages-value\\">Number of Pages</label>\\n              <input type=\\"text\\" class=\\"pages-value\\" name=\\"pages\\" inputmode=\\"numeric\\" value=\\"").concat(formData.pages, "\\" id=\\"pages-value\\" autocomplete=\\"off\\" required />\\n            </div>\\n            <div class=\\"form-group\\">\\n              <label class=\\"check-label\\" for=\\"read-value\\">Read\\n                <input type=\\"checkbox\\" name=\\"read\\" tabindex=\\"-1\\" id=\\"read-value\\" ").concat(formData.read ? \'checked\' : \'\', " autocomplete=\\"off\\" />\\n                <span class=\\"checkmark\\" tabindex=\\"0\\" data-input-id=\\"read-value\\"></span>\\n              </label>\\n            </div>\\n            <div class=\\"button-group\\">\\n              <button type=\\"submit\\" class=\\"button modal-button\\">Save</button>\\n              <button type=\\"button\\" class=\\"button modal-button cancel\\">Cancel</button>\\n            </div>\\n          </form>\\n        </div>\\n      </div>\\n    ");\n      document.querySelector(location).appendChild(bookFormModal);\n      document.querySelector(\'body\').classList.add(\'modal-open\');\n    }\n  }, {\n    key: "removeBookFormModal",\n    value: function removeBookFormModal(location) {\n      var bookFormModal = document.querySelector("".concat(location, " #modal"));\n      bookFormModal ? document.querySelector(location).removeChild(bookFormModal) : null;\n      document.querySelector(\'body\').classList.remove(\'modal-open\');\n    }\n  }]);\n  return BookFormModal;\n}();\n/* harmony default export */ const modules_BookFormModal = (BookFormModal);\n;// ./src/App.js\nfunction App_toConsumableArray(arr) { return App_arrayWithoutHoles(arr) || App_iterableToArray(arr) || App_unsupportedIterableToArray(arr) || App_nonIterableSpread(); }\nfunction App_nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }\nfunction App_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return App_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return App_arrayLikeToArray(o, minLen); }\nfunction App_iterableToArray(iter) { if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null) return Array.from(iter); }\nfunction App_arrayWithoutHoles(arr) { if (Array.isArray(arr)) return App_arrayLikeToArray(arr); }\nfunction App_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\nfunction App_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\nfunction App_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\nfunction App_createClass(Constructor, protoProps, staticProps) { if (protoProps) App_defineProperties(Constructor.prototype, protoProps); if (staticProps) App_defineProperties(Constructor, staticProps); return Constructor; }\n\n\n\n\n\n\nvar App = /*#__PURE__*/function () {\n  function App() {\n    App_classCallCheck(this, App);\n    this.header = new modules_Header();\n    this.footer = new modules_Footer();\n    this.sidebar = new modules_Sidebar();\n    this.readingList = new modules_ReadingList(this.sidebar);\n    this.bookFormModal = new modules_BookFormModal(this.readingList);\n    this.renderApp();\n  }\n\n  // Event listeners\n  App_createClass(App, [{\n    key: "events",\n    value: function events() {\n      var _this = this;\n      document.addEventListener(\'click\', function (event) {\n        var element = event.target;\n        element.matches(\'#modal .modal-button.cancel\') ? _this.bookFormModal.closeModal() : null;\n        element.matches(\'#modal\') ? _this.bookFormModal.closeModal() : null;\n        element.matches(\'.book-card .delete-book-button\') ? _this.readingList.deleteBook(App_toConsumableArray(getReadingList()), element.dataset.id) : null;\n        element.matches(\'.book-card .check-label input[type=checkbox]\') ? _this.readingList.toggleRead(event, element.dataset.id, App_toConsumableArray(getReadingList())) : null;\n        element.matches(\'.sidebar .add-book-button\') ? _this.bookFormModal.openModal(\'add\') : null;\n        element.matches(\'.book-card .edit-book-button\') ? _this.bookFormModal.openModal(\'edit\', App_toConsumableArray(getReadingList()), element.dataset.id) : null;\n      });\n      document.addEventListener(\'change\', function (event) {\n        var element = event.target;\n        element.matches(\'.filter-sort-form #filter-read-value\') ? _this.readingList.handleChange(event) : null;\n        element.matches(\'.filter-sort-form #sort-value\') ? _this.readingList.handleChange(event) : null;\n      });\n      document.addEventListener(\'submit\', function (event) {\n        var element = event.target;\n        element.matches(\'#modal .new-book-form\') ? _this.bookFormModal.handleSubmit(event, {\n          title: document.getElementById(\'title-value\').value,\n          author: document.getElementById(\'author-value\').value,\n          pages: document.getElementById(\'pages-value\').value,\n          read: document.getElementById(\'read-value\').checked\n        }) : null;\n        element.matches(\'.filter-sort-form\') ? event.preventDefault() : null;\n      });\n      document.addEventListener(\'keydown\', function (event) {\n        var element = event.target;\n        document.querySelector(\'#modal\') && event.key === \'Escape\' ? _this.bookFormModal.closeModal() : null;\n        element.matches(\'#modal .new-book-form .checkmark\') ? _this.bookFormModal.handleKeyDown(event) : null;\n        element.matches(\'.book-card .checkmark\') ? _this.readingList.toggleRead(event, element.dataset.id, App_toConsumableArray(getReadingList())) : null;\n      });\n      document.addEventListener(\'keyup\', function (event) {\n        var element = event.target;\n        element.matches(\'.filter-sort-form #search-value\') ? _this.readingList.handleChange(event) : null;\n      });\n    }\n\n    // DOM methods\n  }, {\n    key: "renderApp",\n    value: function renderApp() {\n      this.header.renderHeader(\'#app\');\n      this.renderMain(\'#app\');\n      this.footer.renderFooter(\'#app\');\n      this.sidebar.renderSidebar(\'.reading-list-container\');\n      this.readingList.renderReadingListContent(App_toConsumableArray(getReadingList()), \'.reading-list-container\');\n      this.events();\n    }\n  }, {\n    key: "renderMain",\n    value: function renderMain(location) {\n      var main = document.createElement(\'main\');\n      main.innerHTML = "<div class=\\"reading-list-container\\"></div>";\n      document.querySelector(location).appendChild(main);\n    }\n  }]);\n  return App;\n}();\n/* harmony default export */ const src_App = (App);\n;// ./node_modules/file-loader/dist/cjs.js?name=[name].[ext]!./src/index.html\n/* harmony default export */ const cjsname_name_ext_src = (__webpack_require__.p + "index.html");\n;// ./node_modules/file-loader/dist/cjs.js?name=[name].[ext]!./src/favicon.ico\n/* harmony default export */ const favicon = (__webpack_require__.p + "favicon.ico");\n;// ./src/index.js\n\n\n\n\n\n\nnew src_App();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTgwLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkJBO0FBQ0E7QUFDQTs7QUNGQTtBQUNBO0FBQ0E7O0FDRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0xBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdFFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDVEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4RkE7O0FDQUE7O0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZWFkaW5nLWxpc3QtdmFuaWxsYS1qcy8uL3NyYy9tb2R1bGVzL0hlYWRlci5qcz9lODVjIiwid2VicGFjazovL3JlYWRpbmctbGlzdC12YW5pbGxhLWpzLy4vc3JjL21vZHVsZXMvRm9vdGVyLmpzPzQxM2YiLCJ3ZWJwYWNrOi8vcmVhZGluZy1saXN0LXZhbmlsbGEtanMvLi9zcmMvdXRpbHMvZ2V0TG9jYWxTdG9yYWdlLmpzP2YyMWMiLCJ3ZWJwYWNrOi8vcmVhZGluZy1saXN0LXZhbmlsbGEtanMvLi9zcmMvdXRpbHMvc2V0VG9Mb2NhbFN0b3JhZ2UuanM/MDRjYyIsIndlYnBhY2s6Ly9yZWFkaW5nLWxpc3QtdmFuaWxsYS1qcy8uL3NyYy91dGlscy9nZXRSZWFkaW5nTGlzdC5qcz80NGM3Iiwid2VicGFjazovL3JlYWRpbmctbGlzdC12YW5pbGxhLWpzLy4vc3JjL21vZHVsZXMvU2lkZWJhci5qcz9iOWQxIiwid2VicGFjazovL3JlYWRpbmctbGlzdC12YW5pbGxhLWpzLy4vc3JjL21vZHVsZXMvSW5mb01lc3NhZ2UuanM/YzFjYSIsIndlYnBhY2s6Ly9yZWFkaW5nLWxpc3QtdmFuaWxsYS1qcy8uL3NyYy9tb2R1bGVzL0ZpbHRlclNvcnRGb3JtLmpzPzMwMmEiLCJ3ZWJwYWNrOi8vcmVhZGluZy1saXN0LXZhbmlsbGEtanMvLi9zcmMvbW9kdWxlcy9SZWFkaW5nTGlzdC5qcz9hM2QyIiwid2VicGFjazovL3JlYWRpbmctbGlzdC12YW5pbGxhLWpzLy4vc3JjL21vZHVsZXMvRXJyb3JNZXNzYWdlLmpzPzUxZDkiLCJ3ZWJwYWNrOi8vcmVhZGluZy1saXN0LXZhbmlsbGEtanMvLi9zcmMvbW9kdWxlcy9Cb29rLmpzP2FlYjgiLCJ3ZWJwYWNrOi8vcmVhZGluZy1saXN0LXZhbmlsbGEtanMvLi9zcmMvbW9kdWxlcy9Cb29rRm9ybU1vZGFsLmpzP2RlZmEiLCJ3ZWJwYWNrOi8vcmVhZGluZy1saXN0LXZhbmlsbGEtanMvLi9zcmMvQXBwLmpzPzMzMjciLCJ3ZWJwYWNrOi8vcmVhZGluZy1saXN0LXZhbmlsbGEtanMvLi9zcmMvaW5kZXguaHRtbD83M2NmIiwid2VicGFjazovL3JlYWRpbmctbGlzdC12YW5pbGxhLWpzLy4vc3JjL2Zhdmljb24uaWNvP2FlNzAiLCJ3ZWJwYWNrOi8vcmVhZGluZy1saXN0LXZhbmlsbGEtanMvLi9zcmMvaW5kZXguanM/ZDliZSJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfVxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cbmltcG9ydCBiZ0ltYWdlIGZyb20gJy4uL2Fzc2V0cy9pbWFnZXMvYmFja2dyb3VuZC1pbWFnZS5qcGcnO1xudmFyIEhlYWRlciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEhlYWRlcigpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSGVhZGVyKTtcbiAgfVxuICBfY3JlYXRlQ2xhc3MoSGVhZGVyLCBbe1xuICAgIGtleTogXCJyZW5kZXJIZWFkZXJcIixcbiAgICB2YWx1ZTpcbiAgICAvLyBET00gbWV0aG9kc1xuICAgIGZ1bmN0aW9uIHJlbmRlckhlYWRlcihsb2NhdGlvbikge1xuICAgICAgdmFyIGhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2hlYWRlcicpO1xuICAgICAgaGVhZGVyLmlubmVySFRNTCA9IFwiXFxuICAgICAgPGRpdiBjbGFzcz1cXFwiYmctaW1hZ2VcXFwiIHN0eWxlPVxcXCJiYWNrZ3JvdW5kLWltYWdlOiB1cmwoXCIuY29uY2F0KGJnSW1hZ2UsIFwiKVxcXCI+PC9kaXY+XFxuICAgICAgPGgxPkJ1aWxkIFlvdXIgUmVhZGluZyBMaXN0PC9oMT5cXG4gICAgXCIpO1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihsb2NhdGlvbikuYXBwZW5kQ2hpbGQoaGVhZGVyKTtcbiAgICB9XG4gIH1dKTtcbiAgcmV0dXJuIEhlYWRlcjtcbn0oKTtcbmV4cG9ydCBkZWZhdWx0IEhlYWRlcjsiLCJmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfVxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cbnZhciBGb290ZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBGb290ZXIoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEZvb3Rlcik7XG4gIH1cbiAgX2NyZWF0ZUNsYXNzKEZvb3RlciwgW3tcbiAgICBrZXk6IFwicmVuZGVyRm9vdGVyXCIsXG4gICAgdmFsdWU6XG4gICAgLy8gRE9NIG1ldGhvZHNcbiAgICBmdW5jdGlvbiByZW5kZXJGb290ZXIobG9jYXRpb24pIHtcbiAgICAgIHZhciBmb290ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmb290ZXInKTtcbiAgICAgIGZvb3Rlci5pbm5lckhUTUwgPSBcIkNyZWF0ZWQgYnkgPGEgaHJlZj1cXFwiaHR0cHM6Ly9hdXR1bW5jaHJpcy5naXRodWIuaW8vcG9ydGZvbGlvXFxcIiB0YXJnZXQ9XFxcIl9ibGFua1xcXCI+QXV0dW1uIEJ1bGxhcmQ8L2E+ICZjb3B5OyBcIi5jb25jYXQobmV3IERhdGUoKS5nZXRGdWxsWWVhcigpKTtcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobG9jYXRpb24pLmFwcGVuZENoaWxkKGZvb3Rlcik7XG4gICAgfVxuICB9XSk7XG4gIHJldHVybiBGb290ZXI7XG59KCk7XG5leHBvcnQgZGVmYXVsdCBGb290ZXI7IiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0TG9jYWxTdG9yYWdlKGtleSkge1xuICByZXR1cm4gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpKTtcbn0iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBzZXRUb0xvY2FsU3RvcmFnZShrZXksIHZhbHVlKSB7XG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGtleSwgSlNPTi5zdHJpbmdpZnkodmFsdWUpKTtcbn0iLCJpbXBvcnQgZ2V0TG9jYWxTdG9yYWdlIGZyb20gJy4vZ2V0TG9jYWxTdG9yYWdlJztcbmltcG9ydCBzZXRUb0xvY2FsU3RvcmFnZSBmcm9tICcuL3NldFRvTG9jYWxTdG9yYWdlJztcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFJlYWRpbmdMaXN0KHZhbHVlKSB7XG4gIGlmICh2YWx1ZSkgc2V0VG9Mb2NhbFN0b3JhZ2UoJ3JlYWRpbmdMaXN0JywgdmFsdWUpO1xuICByZXR1cm4gZ2V0TG9jYWxTdG9yYWdlKCdyZWFkaW5nTGlzdCcpIHx8IFtdO1xufSIsImZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHsgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsgfVxuZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UuXFxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLlwiKTsgfVxuZnVuY3Rpb24gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8sIG1pbkxlbikgeyBpZiAoIW8pIHJldHVybjsgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpOyBpZiAobiA9PT0gXCJPYmplY3RcIiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lOyBpZiAobiA9PT0gXCJNYXBcIiB8fCBuID09PSBcIlNldFwiKSByZXR1cm4gQXJyYXkuZnJvbShvKTsgaWYgKG4gPT09IFwiQXJndW1lbnRzXCIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB9XG5mdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHsgaWYgKHR5cGVvZiBTeW1ib2wgIT09IFwidW5kZWZpbmVkXCIgJiYgaXRlcltTeW1ib2wuaXRlcmF0b3JdICE9IG51bGwgfHwgaXRlcltcIkBAaXRlcmF0b3JcIl0gIT0gbnVsbCkgcmV0dXJuIEFycmF5LmZyb20oaXRlcik7IH1cbmZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KGFycik7IH1cbmZ1bmN0aW9uIF9hcnJheUxpa2VUb0FycmF5KGFyciwgbGVuKSB7IGlmIChsZW4gPT0gbnVsbCB8fCBsZW4gPiBhcnIubGVuZ3RoKSBsZW4gPSBhcnIubGVuZ3RoOyBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShsZW4pOyBpIDwgbGVuOyBpKyspIHsgYXJyMltpXSA9IGFycltpXTsgfSByZXR1cm4gYXJyMjsgfVxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cbmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9XG5pbXBvcnQgZ2V0UmVhZGluZ0xpc3QgZnJvbSAnLi4vdXRpbHMvZ2V0UmVhZGluZ0xpc3QnO1xudmFyIFNpZGViYXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBTaWRlYmFyKCkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTaWRlYmFyKTtcbiAgfVxuICBfY3JlYXRlQ2xhc3MoU2lkZWJhciwgW3tcbiAgICBrZXk6IFwicmVuZGVyUmVhZGluZ0xpc3RTdGF0c1wiLFxuICAgIHZhbHVlOlxuICAgIC8vIERPTSBtZXRob2RzXG4gICAgZnVuY3Rpb24gcmVuZGVyUmVhZGluZ0xpc3RTdGF0cyhsb2NhdGlvbikge1xuICAgICAgdmFyIHJlYWRpbmdMaXN0U3RhdHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIHJlYWRpbmdMaXN0U3RhdHMuY2xhc3NMaXN0LmFkZCgncmVhZGluZy1saXN0LXN0YXRzJyk7XG4gICAgICByZWFkaW5nTGlzdFN0YXRzLmlubmVySFRNTCA9IFwiXFxuICAgICAgPGRpdiBjbGFzcz1cXFwic3RhdFxcXCI+PHNwYW4gY2xhc3M9XFxcInN0YXQtbGFiZWxcXFwiPkJvb2tzPC9zcGFuPiBcIi5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGdldFJlYWRpbmdMaXN0KCkpLmxlbmd0aCwgXCI8L2Rpdj5cXG4gICAgICA8ZGl2IGNsYXNzPVxcXCJzdGF0XFxcIj48c3BhbiBjbGFzcz1cXFwic3RhdC1sYWJlbFxcXCI+UmVhZDwvc3Bhbj4gXCIpLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoZ2V0UmVhZGluZ0xpc3QoKSkuZmlsdGVyKGZ1bmN0aW9uIChib29rKSB7XG4gICAgICAgIHJldHVybiBib29rLnJlYWQ7XG4gICAgICB9KS5sZW5ndGgsIFwiPC9kaXY+XFxuICAgICAgPGRpdiBjbGFzcz1cXFwic3RhdFxcXCI+PHNwYW4gY2xhc3M9XFxcInN0YXQtbGFiZWxcXFwiPlVucmVhZDwvc3Bhbj4gXCIpLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoZ2V0UmVhZGluZ0xpc3QoKSkuZmlsdGVyKGZ1bmN0aW9uIChib29rKSB7XG4gICAgICAgIHJldHVybiAhYm9vay5yZWFkO1xuICAgICAgfSkubGVuZ3RoLCBcIjwvZGl2PlxcbiAgICBcIik7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGxvY2F0aW9uKS5hcHBlbmRDaGlsZChyZWFkaW5nTGlzdFN0YXRzKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicmVtb3ZlUmVhZGluZ0xpc3RTdGF0c1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVSZWFkaW5nTGlzdFN0YXRzKGxvY2F0aW9uKSB7XG4gICAgICB2YXIgcmVhZGluZ0xpc3RTdGF0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJcIi5jb25jYXQobG9jYXRpb24sIFwiIC5yZWFkaW5nLWxpc3Qtc3RhdHNcIikpO1xuICAgICAgcmVhZGluZ0xpc3RTdGF0cyA/IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobG9jYXRpb24pLnJlbW92ZUNoaWxkKHJlYWRpbmdMaXN0U3RhdHMpIDogbnVsbDtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicmVuZGVyU2lkZWJhclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJTaWRlYmFyKGxvY2F0aW9uKSB7XG4gICAgICB2YXIgc2lkZWJhciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2FzaWRlJyk7XG4gICAgICBzaWRlYmFyLmNsYXNzTGlzdC5hZGQoJ2NvbCcsICdzaWRlYmFyJyk7XG4gICAgICBzaWRlYmFyLmlubmVySFRNTCA9IFwiXFxuICAgICAgPGRpdiBjbGFzcz1cXFwiYnV0dG9uLWdyb3VwXFxcIj5cXG4gICAgICAgIDxidXR0b24gdHlwZT1cXFwiYnV0dG9uXFxcIiBjbGFzcz1cXFwiYnV0dG9uIGFkZC1ib29rLWJ1dHRvblxcXCI+PHNwYW4gY2xhc3M9XFxcImljb24gZmEtc29saWQgZmEtcGx1c1xcXCIgYXJpYS1oaWRkZW49XFxcInRydWVcXFwiPjwvc3Bhbj4gQWRkIEJvb2s8L2J1dHRvbj5cXG4gICAgICA8L2Rpdj5cXG4gICAgXCI7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGxvY2F0aW9uKS5hcHBlbmRDaGlsZChzaWRlYmFyKTtcbiAgICAgIHRoaXMucmVuZGVyUmVhZGluZ0xpc3RTdGF0cygnLnNpZGViYXInKTtcbiAgICB9XG4gIH1dKTtcbiAgcmV0dXJuIFNpZGViYXI7XG59KCk7XG5leHBvcnQgZGVmYXVsdCBTaWRlYmFyOyIsImZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9XG5mdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfVxudmFyIEluZm9NZXNzYWdlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gSW5mb01lc3NhZ2UoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEluZm9NZXNzYWdlKTtcbiAgfVxuICBfY3JlYXRlQ2xhc3MoSW5mb01lc3NhZ2UsIFt7XG4gICAga2V5OiBcInJlbmRlckluZm9NZXNzYWdlXCIsXG4gICAgdmFsdWU6XG4gICAgLy8gRE9NIG1ldGhvZHNcbiAgICBmdW5jdGlvbiByZW5kZXJJbmZvTWVzc2FnZShtZXNzYWdlLCBsb2NhdGlvbikge1xuICAgICAgdmFyIGluZm9NZXNzYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICAgICAgaW5mb01lc3NhZ2UuY2xhc3NMaXN0LmFkZCgnbWVzc2FnZScsICdpbmZvLW1lc3NhZ2UnKTtcbiAgICAgIGluZm9NZXNzYWdlLmlubmVySFRNTCA9IFwiPHNwYW4gY2xhc3M9XFxcImZhLXNvbGlkIGZhLWNpcmNsZS1pbmZvIGZhLWxnIGZhLWZ3XFxcIiBhcmlhLWhpZGRlbj1cXFwidHJ1ZVxcXCI+PC9zcGFuPiBcIi5jb25jYXQobWVzc2FnZSk7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGxvY2F0aW9uKS5hcHBlbmRDaGlsZChpbmZvTWVzc2FnZSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInJlbW92ZUluZm9NZXNzYWdlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZUluZm9NZXNzYWdlKGxvY2F0aW9uKSB7XG4gICAgICB2YXIgaW5mb01lc3NhZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiXCIuY29uY2F0KGxvY2F0aW9uLCBcIiAuaW5mby1tZXNzYWdlXCIpKTtcbiAgICAgIGluZm9NZXNzYWdlID8gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihsb2NhdGlvbikucmVtb3ZlQ2hpbGQoaW5mb01lc3NhZ2UpIDogbnVsbDtcbiAgICB9XG4gIH1dKTtcbiAgcmV0dXJuIEluZm9NZXNzYWdlO1xufSgpO1xuZXhwb3J0IGRlZmF1bHQgSW5mb01lc3NhZ2U7IiwiZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cbmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9XG52YXIgRmlsdGVyU29ydEZvcm0gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBGaWx0ZXJTb3J0Rm9ybSgpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRmlsdGVyU29ydEZvcm0pO1xuICB9XG4gIF9jcmVhdGVDbGFzcyhGaWx0ZXJTb3J0Rm9ybSwgW3tcbiAgICBrZXk6IFwicmVuZGVyRmlsdGVyU29ydEZvcm1cIixcbiAgICB2YWx1ZTpcbiAgICAvLyBET00gbWV0aG9kc1xuICAgIGZ1bmN0aW9uIHJlbmRlckZpbHRlclNvcnRGb3JtKGxvY2F0aW9uLCBmaWx0ZXJTb3J0Rm9ybURhdGEpIHtcbiAgICAgIHZhciBmaWx0ZXJTb3J0Rm9ybSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2Zvcm0nKTtcbiAgICAgIGZpbHRlclNvcnRGb3JtLmNsYXNzTGlzdC5hZGQoJ2ZpbHRlci1zb3J0LWZvcm0nKTtcbiAgICAgIGZpbHRlclNvcnRGb3JtLnNldEF0dHJpYnV0ZSgnbm92YWxpZGF0ZScsICd0cnVlJyk7XG4gICAgICBmaWx0ZXJTb3J0Rm9ybS5pbm5lckhUTUwgPSBcIlxcbiAgICAgIDxkaXYgY2xhc3M9XFxcInJvdyByb3ctc2VhcmNoXFxcIj5cXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcImZvcm0tZ3JvdXBcXFwiPlxcbiAgICAgICAgICA8bGFiZWwgZm9yPVxcXCJzZWFyY2gtdmFsdWVcXFwiPkZpbHRlciBieSBLZXl3b3JkPC9sYWJlbD5cXG4gICAgICAgICAgPGlucHV0IHR5cGU9XFxcInRleHRcXFwiIG5hbWU9XFxcInNlYXJjaFZhbHVlXFxcIiBjbGFzcz1cXFwic2VhcmNoLXZhbHVlXFxcIiB2YWx1ZT1cXFwiXCIuY29uY2F0KGZpbHRlclNvcnRGb3JtRGF0YS5zZWFyY2hWYWx1ZSwgXCJcXFwiIHBsYWNlaG9sZGVyPVxcXCJGaW5kIGEgYm9vay4uLlxcXCIgaWQ9XFxcInNlYXJjaC12YWx1ZVxcXCIgYXV0b0NvbXBsZXRlPVxcXCJvZmZcXFwiIGF1dG9jYXBpdGFsaXplPVxcXCJvZmZcXFwiIC8+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICA8L2Rpdj5cXG4gICAgICA8ZGl2IGNsYXNzPVxcXCJyb3cgcm93LXNlbGVjdFxcXCI+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWdyb3VwXFxcIj5cXG4gICAgICAgICAgPGxhYmVsIGZvcj1cXFwiZmlsdGVyLXJlYWQtdmFsdWVcXFwiPkZpbHRlciBieSBSZWFkIFN0YXR1czwvbGFiZWw+XFxuICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInNlbGVjdC13cmFwcGVyXFxcIj5cXG4gICAgICAgICAgICA8c2VsZWN0IG5hbWU9XFxcImZpbHRlclJlYWRWYWx1ZVxcXCIgaWQ9XFxcImZpbHRlci1yZWFkLXZhbHVlXFxcIiBhdXRvQ29tcGxldGU9XFxcIm9mZlxcXCI+XFxuICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVxcXCJhbGxcXFwiIFwiKS5jb25jYXQoZmlsdGVyU29ydEZvcm1EYXRhLmZpbHRlclJlYWRWYWx1ZSA9PT0gJ2FsbCcgPyAnc2VsZWN0ZWQnIDogJycsIFwiPkFsbDwvb3B0aW9uPlxcbiAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cXFwicmVhZFxcXCIgXCIpLmNvbmNhdChmaWx0ZXJTb3J0Rm9ybURhdGEuZmlsdGVyUmVhZFZhbHVlID09PSAncmVhZCcgPyAnc2VsZWN0ZWQnIDogJycsIFwiPlJlYWQ8L29wdGlvbj5cXG4gICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XFxcInVucmVhZFxcXCIgXCIpLmNvbmNhdChmaWx0ZXJTb3J0Rm9ybURhdGEuZmlsdGVyUmVhZFZhbHVlID09PSAndW5yZWFkJyA/ICdzZWxlY3RlZCcgOiAnJywgXCI+VW5yZWFkPC9vcHRpb24+XFxuICAgICAgICAgICAgPC9zZWxlY3Q+XFxuICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWdyb3VwXFxcIj5cXG4gICAgICAgICAgPGxhYmVsIGZvcj1cXFwic29ydC12YWx1ZVxcXCI+T3JkZXIgYnk8L2xhYmVsPlxcbiAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJzZWxlY3Qtd3JhcHBlclxcXCI+XFxuICAgICAgICAgICAgPHNlbGVjdCBuYW1lPVxcXCJzb3J0VmFsdWVcXFwiIGlkPVxcXCJzb3J0LXZhbHVlXFxcIiBhdXRvQ29tcGxldGU9XFxcIm9mZlxcXCI+XFxuICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVxcXCJ0aXRsZVxcXCIgXCIpLmNvbmNhdChmaWx0ZXJTb3J0Rm9ybURhdGEuc29ydFZhbHVlID09PSAndGl0bGUnID8gJ3NlbGVjdGVkJyA6ICcnLCBcIj5UaXRsZTwvb3B0aW9uPlxcbiAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cXFwiZmlyc3QtbmFtZVxcXCIgXCIpLmNvbmNhdChmaWx0ZXJTb3J0Rm9ybURhdGEuc29ydFZhbHVlID09PSAnZmlyc3QtbmFtZScgPyAnc2VsZWN0ZWQnIDogJycsIFwiPkF1dGhvcjogRmlyc3QgTmFtZTwvb3B0aW9uPlxcbiAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cXFwibGFzdC1uYW1lXFxcIiBcIikuY29uY2F0KGZpbHRlclNvcnRGb3JtRGF0YS5zb3J0VmFsdWUgPT09ICdsYXN0LW5hbWUnID8gJ3NlbGVjdGVkJyA6ICcnLCBcIj5BdXRob3I6IExhc3QgTmFtZTwvb3B0aW9uPlxcbiAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cXFwicGFnZXMtbGVhc3RcXFwiIFwiKS5jb25jYXQoZmlsdGVyU29ydEZvcm1EYXRhLnNvcnRWYWx1ZSA9PT0gJ3BhZ2VzLWxlYXN0JyA/ICdzZWxlY3RlZCcgOiAnJywgXCI+UGFnZXM6IExlYXN0IHRvIEdyZWF0ZXN0PC9vcHRpb24+XFxuICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVxcXCJwYWdlcy1ncmVhdGVzdFxcXCIgXCIpLmNvbmNhdChmaWx0ZXJTb3J0Rm9ybURhdGEuc29ydFZhbHVlID09PSAncGFnZXMtZ3JlYXRlc3QnID8gJ3NlbGVjdGVkJyA6ICcnLCBcIj5QYWdlczogR3JlYXRlc3QgdG8gTGVhc3Q8L29wdGlvbj5cXG4gICAgICAgICAgICA8L3NlbGVjdD5cXG4gICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICA8L2Rpdj5cXG4gICAgXCIpO1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihsb2NhdGlvbikuYXBwZW5kQ2hpbGQoZmlsdGVyU29ydEZvcm0pO1xuICAgIH1cbiAgfV0pO1xuICByZXR1cm4gRmlsdGVyU29ydEZvcm07XG59KCk7XG5leHBvcnQgZGVmYXVsdCBGaWx0ZXJTb3J0Rm9ybTsiLCJmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsgaWYgKGVudW1lcmFibGVPbmx5KSB7IHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsgfSBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7IH0gcmV0dXJuIGtleXM7IH1cbmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpZiAoaSAlIDIpIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KTsgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgeyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOyB9IGVsc2UgeyBvd25LZXlzKE9iamVjdChzb3VyY2UpKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7IH0pOyB9IH0gcmV0dXJuIHRhcmdldDsgfVxuZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgeyBpZiAoa2V5IGluIG9iaikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsgdmFsdWU6IHZhbHVlLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pOyB9IGVsc2UgeyBvYmpba2V5XSA9IHZhbHVlOyB9IHJldHVybiBvYmo7IH1cbmZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHsgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsgfVxuZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UuXFxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLlwiKTsgfVxuZnVuY3Rpb24gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8sIG1pbkxlbikgeyBpZiAoIW8pIHJldHVybjsgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpOyBpZiAobiA9PT0gXCJPYmplY3RcIiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lOyBpZiAobiA9PT0gXCJNYXBcIiB8fCBuID09PSBcIlNldFwiKSByZXR1cm4gQXJyYXkuZnJvbShvKTsgaWYgKG4gPT09IFwiQXJndW1lbnRzXCIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB9XG5mdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHsgaWYgKHR5cGVvZiBTeW1ib2wgIT09IFwidW5kZWZpbmVkXCIgJiYgaXRlcltTeW1ib2wuaXRlcmF0b3JdICE9IG51bGwgfHwgaXRlcltcIkBAaXRlcmF0b3JcIl0gIT0gbnVsbCkgcmV0dXJuIEFycmF5LmZyb20oaXRlcik7IH1cbmZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KGFycik7IH1cbmZ1bmN0aW9uIF9hcnJheUxpa2VUb0FycmF5KGFyciwgbGVuKSB7IGlmIChsZW4gPT0gbnVsbCB8fCBsZW4gPiBhcnIubGVuZ3RoKSBsZW4gPSBhcnIubGVuZ3RoOyBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShsZW4pOyBpIDwgbGVuOyBpKyspIHsgYXJyMltpXSA9IGFycltpXTsgfSByZXR1cm4gYXJyMjsgfVxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cbmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9XG5pbXBvcnQgSW5mb01lc3NhZ2UgZnJvbSAnLi9JbmZvTWVzc2FnZSc7XG5pbXBvcnQgRmlsdGVyU29ydEZvcm0gZnJvbSAnLi9GaWx0ZXJTb3J0Rm9ybSc7XG5pbXBvcnQgZ2V0UmVhZGluZ0xpc3QgZnJvbSAnLi4vdXRpbHMvZ2V0UmVhZGluZ0xpc3QnO1xudmFyIFJlYWRpbmdMaXN0ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gUmVhZGluZ0xpc3Qoc2lkZWJhckluc3RhbmNlKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJlYWRpbmdMaXN0KTtcbiAgICB0aGlzLmluZm9NZXNzYWdlID0gbmV3IEluZm9NZXNzYWdlKCk7XG4gICAgdGhpcy5zaWRlYmFyID0gc2lkZWJhckluc3RhbmNlO1xuICAgIHRoaXMuZmlsdGVyU29ydEZvcm0gPSBuZXcgRmlsdGVyU29ydEZvcm0oKTtcbiAgICB0aGlzLnZpZXdhYmxlUmVhZGluZ0xpc3QgPSBfdG9Db25zdW1hYmxlQXJyYXkoZ2V0UmVhZGluZ0xpc3QoKSk7XG4gICAgdGhpcy5maWx0ZXJTb3J0Rm9ybURhdGEgPSB7XG4gICAgICBzZWFyY2hWYWx1ZTogJycsXG4gICAgICBmaWx0ZXJSZWFkVmFsdWU6ICdhbGwnLFxuICAgICAgc29ydFZhbHVlOiAndGl0bGUnXG4gICAgfTtcbiAgICB0aGlzLmVkaXRCb29rRm9ybURhdGEgPSB7XG4gICAgICB0aXRsZTogJycsXG4gICAgICBhdXRob3I6ICcnLFxuICAgICAgcGFnZXM6ICcnLFxuICAgICAgcmVhZDogZmFsc2UsXG4gICAgICBpZDogbnVsbFxuICAgIH07XG4gIH1cblxuICAvLyBVcGRhdGUgZmlsdGVyU29ydEZvcm1EYXRhIHZhcmlhYmxlIHdoZW4gdGhlIEZpbHRlci9Tb3J0IGZvcm0gaW5wdXRzIGNoYW5nZVxuICBfY3JlYXRlQ2xhc3MoUmVhZGluZ0xpc3QsIFt7XG4gICAga2V5OiBcImhhbmRsZUNoYW5nZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBoYW5kbGVDaGFuZ2UoZXZlbnQpIHtcbiAgICAgIHRoaXMuZmlsdGVyU29ydEZvcm1EYXRhID0gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCB0aGlzLmZpbHRlclNvcnRGb3JtRGF0YSksIHt9LCBfZGVmaW5lUHJvcGVydHkoe30sIGV2ZW50LnRhcmdldC5uYW1lLCBldmVudC50YXJnZXQudmFsdWUpKTtcbiAgICAgIHRoaXMudXBkYXRlVmlld2FibGVSZWFkaW5nTGlzdCgpO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSB2aWV3YWJsZSByZWFkaW5nIGxpc3QgYmFzZWQgb24gRmlsdGVyL1NvcnQgZm9ybSBpbnB1dHNcbiAgfSwge1xuICAgIGtleTogXCJ1cGRhdGVWaWV3YWJsZVJlYWRpbmdMaXN0XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZVZpZXdhYmxlUmVhZGluZ0xpc3QoKSB7XG4gICAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZpbHRlci1zb3J0LWZvcm0nKSkge1xuICAgICAgICB0aGlzLmZpbHRlclNvcnRGb3JtRGF0YS5zZWFyY2hWYWx1ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWFyY2gtdmFsdWUnKS52YWx1ZTtcbiAgICAgICAgdGhpcy5maWx0ZXJTb3J0Rm9ybURhdGEuZmlsdGVyUmVhZFZhbHVlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbHRlci1yZWFkLXZhbHVlJykudmFsdWU7XG4gICAgICAgIHRoaXMuZmlsdGVyU29ydEZvcm1EYXRhLnNvcnRWYWx1ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzb3J0LXZhbHVlJykudmFsdWU7XG4gICAgICB9XG4gICAgICB2YXIgdmlld2FibGVSZWFkaW5nTGlzdERhdGEgPSBfdG9Db25zdW1hYmxlQXJyYXkoZ2V0UmVhZGluZ0xpc3QoKSk7XG4gICAgICB2aWV3YWJsZVJlYWRpbmdMaXN0RGF0YSA9IHRoaXMuc2VhcmNoUmVhZGluZ0xpc3QodGhpcy5maWx0ZXJTb3J0Rm9ybURhdGEuc2VhcmNoVmFsdWUsIHZpZXdhYmxlUmVhZGluZ0xpc3REYXRhKTtcbiAgICAgIHZpZXdhYmxlUmVhZGluZ0xpc3REYXRhID0gdGhpcy5maWx0ZXJCeVJlYWRTdGF0dXModGhpcy5maWx0ZXJTb3J0Rm9ybURhdGEuZmlsdGVyUmVhZFZhbHVlLCB2aWV3YWJsZVJlYWRpbmdMaXN0RGF0YSk7XG4gICAgICB2aWV3YWJsZVJlYWRpbmdMaXN0RGF0YSA9IHRoaXMuc29ydEJvb2tzKHRoaXMuZmlsdGVyU29ydEZvcm1EYXRhLnNvcnRWYWx1ZSwgdmlld2FibGVSZWFkaW5nTGlzdERhdGEpO1xuICAgICAgdGhpcy52aWV3YWJsZVJlYWRpbmdMaXN0ID0gdmlld2FibGVSZWFkaW5nTGlzdERhdGE7XG4gICAgICBpZiAoX3RvQ29uc3VtYWJsZUFycmF5KGdldFJlYWRpbmdMaXN0KCkpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICB0aGlzLnJlbW92ZVJlYWRpbmdMaXN0Q29udGVudCgnLnJlYWRpbmctbGlzdC1jb250YWluZXInKTtcbiAgICAgICAgdGhpcy5yZW5kZXJSZWFkaW5nTGlzdENvbnRlbnQoX3RvQ29uc3VtYWJsZUFycmF5KGdldFJlYWRpbmdMaXN0KCkpLCAnLnJlYWRpbmctbGlzdC1jb250YWluZXInKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucmVtb3ZlUmVhZGluZ0xpc3QoJy5yZWFkaW5nLWxpc3QtY29udGVudCcpO1xuICAgICAgICB0aGlzLnJlbmRlclJlYWRpbmdMaXN0KHZpZXdhYmxlUmVhZGluZ0xpc3REYXRhLCAnLnJlYWRpbmctbGlzdC1jb250ZW50Jyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRmlsdGVyIHZpZXdhYmxlIHJlYWRpbmcgbGlzdCBieSBzZWFyY2ggaW5wdXRcbiAgfSwge1xuICAgIGtleTogXCJzZWFyY2hSZWFkaW5nTGlzdFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzZWFyY2hSZWFkaW5nTGlzdCh2YWx1ZSwgdmlld2FibGVSZWFkaW5nTGlzdERhdGEpIHtcbiAgICAgIHZhbHVlID0gdmFsdWUudG9Mb3dlckNhc2UoKTtcbiAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdmlld2FibGVSZWFkaW5nTGlzdERhdGEuZmlsdGVyKGZ1bmN0aW9uIChib29rKSB7XG4gICAgICAgICAgcmV0dXJuIGJvb2sudGl0bGUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyh2YWx1ZSkgfHwgYm9vay5hdXRob3IudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyh2YWx1ZSk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHZpZXdhYmxlUmVhZGluZ0xpc3REYXRhO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEZpbHRlciB2aWV3YWJsZSByZWFkaW5nIGxpc3QgYnkgUmVhZCBzdGF0dXNcbiAgfSwge1xuICAgIGtleTogXCJmaWx0ZXJCeVJlYWRTdGF0dXNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZmlsdGVyQnlSZWFkU3RhdHVzKHZhbHVlLCB2aWV3YWJsZVJlYWRpbmdMaXN0RGF0YSkge1xuICAgICAgdmlld2FibGVSZWFkaW5nTGlzdERhdGEgPSB2aWV3YWJsZVJlYWRpbmdMaXN0RGF0YS5maWx0ZXIoZnVuY3Rpb24gKGJvb2spIHtcbiAgICAgICAgaWYgKHZhbHVlID09PSAncmVhZCcpIHtcbiAgICAgICAgICByZXR1cm4gYm9vay5yZWFkO1xuICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID09PSAndW5yZWFkJykge1xuICAgICAgICAgIHJldHVybiAhYm9vay5yZWFkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBib29rO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiB2aWV3YWJsZVJlYWRpbmdMaXN0RGF0YTtcbiAgICB9XG5cbiAgICAvLyBTb3J0IHZpZXdhYmxlIHJlYWRpbmcgbGlzdFxuICB9LCB7XG4gICAga2V5OiBcInNvcnRCb29rc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzb3J0Qm9va3ModmFsdWUsIHZpZXdhYmxlUmVhZGluZ0xpc3REYXRhKSB7XG4gICAgICB2aWV3YWJsZVJlYWRpbmdMaXN0RGF0YSA9IHZpZXdhYmxlUmVhZGluZ0xpc3REYXRhLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgdmFyIGF1dGhvck5hbWVBID0gYS5hdXRob3IudG9Mb3dlckNhc2UoKS5zcGxpdCgnICcpO1xuICAgICAgICB2YXIgYXV0aG9yTmFtZUIgPSBiLmF1dGhvci50b0xvd2VyQ2FzZSgpLnNwbGl0KCcgJyk7XG4gICAgICAgIHZhciBsYXN0TmFtZUEgPSBhdXRob3JOYW1lQVthdXRob3JOYW1lQS5sZW5ndGggLSAxXTtcbiAgICAgICAgdmFyIGxhc3ROYW1lQiA9IGF1dGhvck5hbWVCW2F1dGhvck5hbWVCLmxlbmd0aCAtIDFdO1xuICAgICAgICB2YXIgZmlyc3ROYW1lQSA9IGF1dGhvck5hbWVBWzBdO1xuICAgICAgICB2YXIgZmlyc3ROYW1lQiA9IGF1dGhvck5hbWVCWzBdO1xuICAgICAgICBzd2l0Y2ggKHZhbHVlKSB7XG4gICAgICAgICAgY2FzZSAndGl0bGUnOlxuICAgICAgICAgICAgcmV0dXJuIGEudGl0bGUudG9Mb3dlckNhc2UoKS5sb2NhbGVDb21wYXJlKGIudGl0bGUudG9Mb3dlckNhc2UoKSk7XG4gICAgICAgICAgY2FzZSAnZmlyc3QtbmFtZSc6XG4gICAgICAgICAgICBpZiAobGFzdE5hbWVBID09PSBsYXN0TmFtZUIgJiYgZmlyc3ROYW1lQSA9PT0gZmlyc3ROYW1lQiAmJiBhdXRob3JOYW1lQS5sZW5ndGggPiBhdXRob3JOYW1lQi5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGF1dGhvck5hbWVCLmpvaW4oJyAnKS5sb2NhbGVDb21wYXJlKGF1dGhvck5hbWVBLmpvaW4oJyAnKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICByZXR1cm4gYXV0aG9yTmFtZUEuam9pbignICcpLmxvY2FsZUNvbXBhcmUoYXV0aG9yTmFtZUIuam9pbignICcpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBjYXNlICdsYXN0LW5hbWUnOlxuICAgICAgICAgICAgaWYgKGxhc3ROYW1lQSA9PT0gbGFzdE5hbWVCKSB7XG4gICAgICAgICAgICAgIGF1dGhvck5hbWVBLnBvcCgpO1xuICAgICAgICAgICAgICBhdXRob3JOYW1lQi5wb3AoKTtcbiAgICAgICAgICAgICAgcmV0dXJuIGF1dGhvck5hbWVBLmpvaW4oJyAnKS5sb2NhbGVDb21wYXJlKGF1dGhvck5hbWVCLmpvaW4oJyAnKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICByZXR1cm4gbGFzdE5hbWVBLmxvY2FsZUNvbXBhcmUobGFzdE5hbWVCKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBjYXNlICdwYWdlcy1sZWFzdCc6XG4gICAgICAgICAgICByZXR1cm4gYS5wYWdlcyAtIGIucGFnZXM7XG4gICAgICAgICAgY2FzZSAncGFnZXMtZ3JlYXRlc3QnOlxuICAgICAgICAgICAgcmV0dXJuIGIucGFnZXMgLSBhLnBhZ2VzO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiB2aWV3YWJsZVJlYWRpbmdMaXN0RGF0YTtcbiAgICB9XG5cbiAgICAvLyBBZGQgYSBuZXcgYm9vayB0byB0aGUgcmVhZGluZyBsaXN0XG4gIH0sIHtcbiAgICBrZXk6IFwiYWRkTmV3Qm9va1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBhZGROZXdCb29rKG5ld0Jvb2ssIHJlYWRpbmdMaXN0RGF0YSkge1xuICAgICAgdmFyIHdhc0VtcHR5ID0gcmVhZGluZ0xpc3REYXRhLmxlbmd0aCA9PT0gMDtcbiAgICAgIHJlYWRpbmdMaXN0RGF0YS5wdXNoKG5ld0Jvb2spO1xuICAgICAgZ2V0UmVhZGluZ0xpc3QocmVhZGluZ0xpc3REYXRhKTtcbiAgICAgIGlmICh3YXNFbXB0eSkge1xuICAgICAgICB0aGlzLmZpbHRlclNvcnRGb3JtLnJlbmRlckZpbHRlclNvcnRGb3JtKCcucmVhZGluZy1saXN0LWNvbnRlbnQnLCB0aGlzLmZpbHRlclNvcnRGb3JtRGF0YSk7XG4gICAgICB9XG4gICAgICB0aGlzLnVwZGF0ZVZpZXdhYmxlUmVhZGluZ0xpc3QoKTtcbiAgICAgIHRoaXMuc2lkZWJhci5yZW1vdmVSZWFkaW5nTGlzdFN0YXRzKCcuc2lkZWJhcicpO1xuICAgICAgdGhpcy5zaWRlYmFyLnJlbmRlclJlYWRpbmdMaXN0U3RhdHMoJy5zaWRlYmFyJyk7XG4gICAgfVxuXG4gICAgLy8gRWRpdCBhIGJvb2sgaW4gdGhlIHJlYWRpbmcgbGlzdFxuICB9LCB7XG4gICAga2V5OiBcImVkaXRCb29rXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGVkaXRCb29rKGVkaXRCb29rRm9ybURhdGEsIGJvb2tJRCwgcmVhZGluZ0xpc3REYXRhKSB7XG4gICAgICByZWFkaW5nTGlzdERhdGEgPSByZWFkaW5nTGlzdERhdGEubWFwKGZ1bmN0aW9uIChib29rKSB7XG4gICAgICAgIGlmIChib29rLmlkID09PSBOdW1iZXIoYm9va0lEKSkge1xuICAgICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIGJvb2spLCB7fSwge1xuICAgICAgICAgICAgdGl0bGU6IGVkaXRCb29rRm9ybURhdGEudGl0bGUsXG4gICAgICAgICAgICBhdXRob3I6IGVkaXRCb29rRm9ybURhdGEuYXV0aG9yLFxuICAgICAgICAgICAgcGFnZXM6IGVkaXRCb29rRm9ybURhdGEucGFnZXMsXG4gICAgICAgICAgICByZWFkOiBlZGl0Qm9va0Zvcm1EYXRhLnJlYWRcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gYm9vaztcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBnZXRSZWFkaW5nTGlzdChyZWFkaW5nTGlzdERhdGEpO1xuICAgICAgdGhpcy51cGRhdGVWaWV3YWJsZVJlYWRpbmdMaXN0KCk7XG4gICAgICB0aGlzLnNpZGViYXIucmVtb3ZlUmVhZGluZ0xpc3RTdGF0cygnLnNpZGViYXInKTtcbiAgICAgIHRoaXMuc2lkZWJhci5yZW5kZXJSZWFkaW5nTGlzdFN0YXRzKCcuc2lkZWJhcicpO1xuICAgIH1cblxuICAgIC8vIERlbGV0ZSBhIGJvb2sgZnJvbSB0aGUgcmVhZGluZyBsaXN0XG4gIH0sIHtcbiAgICBrZXk6IFwiZGVsZXRlQm9va1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBkZWxldGVCb29rKHJlYWRpbmdMaXN0RGF0YSwgYm9va0lEKSB7XG4gICAgICBpZiAoY29uZmlybSgnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIHJlbW92ZSB0aGlzIGJvb2sgZnJvbSB5b3VyIHJlYWRpbmcgbGlzdD8nKSkge1xuICAgICAgICByZWFkaW5nTGlzdERhdGEgPSByZWFkaW5nTGlzdERhdGEuZmlsdGVyKGZ1bmN0aW9uIChib29rKSB7XG4gICAgICAgICAgcmV0dXJuIGJvb2suaWQgIT09IE51bWJlcihib29rSUQpO1xuICAgICAgICB9KTtcbiAgICAgICAgZ2V0UmVhZGluZ0xpc3QocmVhZGluZ0xpc3REYXRhKTtcbiAgICAgICAgdGhpcy51cGRhdGVWaWV3YWJsZVJlYWRpbmdMaXN0KCk7XG4gICAgICAgIHRoaXMuc2lkZWJhci5yZW1vdmVSZWFkaW5nTGlzdFN0YXRzKCcuc2lkZWJhcicpO1xuICAgICAgICB0aGlzLnNpZGViYXIucmVuZGVyUmVhZGluZ0xpc3RTdGF0cygnLnNpZGViYXInKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBUb2dnbGUgYSBib29rJ3MgcmVhZCBzdGF0dXMgaW4gdGhlIHJlYWRpbmcgbGlzdFxuICB9LCB7XG4gICAga2V5OiBcInRvZ2dsZVJlYWRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gdG9nZ2xlUmVhZChldmVudCwgYm9va0lELCByZWFkaW5nTGlzdERhdGEpIHtcbiAgICAgIGlmIChldmVudC50eXBlID09PSAnY2xpY2snICYmICFldmVudC50YXJnZXQubWF0Y2hlcygnaW5wdXRbdHlwZT1jaGVja2JveF0nKSkgcmV0dXJuO1xuICAgICAgaWYgKGV2ZW50LmtleSA9PT0gJ0VudGVyJyB8fCBldmVudC5rZXkgPT09ICcgJykge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJlYWQtXCIuY29uY2F0KGJvb2tJRCkpLmNoZWNrZWQgPSAhZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZWFkLVwiLmNvbmNhdChib29rSUQpKS5jaGVja2VkO1xuICAgICAgfVxuICAgICAgaWYgKGV2ZW50LmtleSA9PT0gJ0VudGVyJyB8fCBldmVudC5rZXkgPT09ICcgJyB8fCBldmVudC50eXBlID09PSAnY2xpY2snKSB7XG4gICAgICAgIHJlYWRpbmdMaXN0RGF0YSA9IHJlYWRpbmdMaXN0RGF0YS5tYXAoZnVuY3Rpb24gKGJvb2spIHtcbiAgICAgICAgICBpZiAoYm9vay5pZCA9PT0gTnVtYmVyKGJvb2tJRCkpIHtcbiAgICAgICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIGJvb2spLCB7fSwge1xuICAgICAgICAgICAgICByZWFkOiAhYm9vay5yZWFkXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGJvb2s7XG4gICAgICAgIH0pO1xuICAgICAgICBnZXRSZWFkaW5nTGlzdChyZWFkaW5nTGlzdERhdGEpO1xuICAgICAgICB0aGlzLnVwZGF0ZVZpZXdhYmxlUmVhZGluZ0xpc3QoKTtcbiAgICAgICAgdGhpcy5zaWRlYmFyLnJlbW92ZVJlYWRpbmdMaXN0U3RhdHMoJy5zaWRlYmFyJyk7XG4gICAgICAgIHRoaXMuc2lkZWJhci5yZW5kZXJSZWFkaW5nTGlzdFN0YXRzKCcuc2lkZWJhcicpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIERPTSBtZXRob2RzXG4gIH0sIHtcbiAgICBrZXk6IFwicmVuZGVyQm9va3NcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyQm9va3MocmVhZGluZ0xpc3REYXRhKSB7XG4gICAgICB2YXIgcmVhZGluZ0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucmVhZGluZy1saXN0Jyk7XG4gICAgICByZWFkaW5nTGlzdC5pbm5lckhUTUwgPSByZWFkaW5nTGlzdERhdGEubWFwKGZ1bmN0aW9uIChib29rKSB7XG4gICAgICAgIHJldHVybiBcIlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwiYm9vay1jYXJkXFxcIj5cXG4gICAgICAgICAgPGRpdiBjbGFzcz1cXFwicm93XFxcIj5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJ0aXRsZVxcXCI+XCIuY29uY2F0KGJvb2sudGl0bGUsIFwiPC9kaXY+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiYnV0dG9uLWdyb3VwXFxcIj5cXG4gICAgICAgICAgICAgIDxidXR0b24gdHlwZT1cXFwiYnV0dG9uXFxcIiBjbGFzcz1cXFwiYnV0dG9uIGVkaXQtYm9vay1idXR0b25cXFwiIGRhdGEtaWQ9XFxcIlwiKS5jb25jYXQoYm9vay5pZCwgXCJcXFwiIGFyaWEtbGFiZWw9XFxcImVkaXQgYm9vayBcIikuY29uY2F0KGJvb2sudGl0bGUsIFwiIGJ5IFwiKS5jb25jYXQoYm9vay5hdXRob3IsIFwiXFxcIiB0aXRsZT1cXFwiRWRpdFxcXCI+XFxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVxcXCJmYS1zb2xpZCBmYS1wZW5jaWwgZmEtc20gZmEtZncgaWNvblxcXCI+PC9zcGFuPlxcbiAgICAgICAgICAgICAgPC9idXR0b24+XFxuICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9XFxcImJ1dHRvblxcXCIgY2xhc3M9XFxcImJ1dHRvbiBkZWxldGUtYm9vay1idXR0b25cXFwiIGRhdGEtaWQ9XFxcIlwiKS5jb25jYXQoYm9vay5pZCwgXCJcXFwiIGFyaWEtbGFiZWw9XFxcImRlbGV0ZSBib29rIFwiKS5jb25jYXQoYm9vay50aXRsZSwgXCIgYnkgXCIpLmNvbmNhdChib29rLmF1dGhvciwgXCJcXFwiIHRpdGxlPVxcXCJEZWxldGVcXFwiPlxcbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cXFwiZmEtc29saWQgZmEtdHJhc2ggZmEtc20gaWNvblxcXCI+PC9zcGFuPlxcbiAgICAgICAgICAgICAgPC9idXR0b24+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJyb3dcXFwiPlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImJvb2staW5mbyBhdXRob3JcXFwiPjxzcGFuIGNsYXNzPVxcXCJib29rLWluZm8tbGFiZWxcXFwiPmJ5IDwvc3Bhbj5cIikuY29uY2F0KGJvb2suYXV0aG9yLCBcIjwvZGl2PlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImJvb2staW5mbyBwYWdlc1xcXCI+PHNwYW4gY2xhc3M9XFxcImJvb2staW5mby1sYWJlbFxcXCI+UGFnZXMgPC9zcGFuPlwiKS5jb25jYXQoYm9vay5wYWdlcywgXCI8L2Rpdj5cXG4gICAgICAgICAgICA8Zm9ybSBub3ZhbGlkYXRlPlxcbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ncm91cFxcXCI+XFxuICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz1cXFwiY2hlY2stbGFiZWxcXFwiIGZvcj1cXFwicmVhZC1cIikuY29uY2F0KGJvb2suaWQsIFwiXFxcIj5SZWFkXFxuICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XFxcImNoZWNrYm94XFxcIiBuYW1lPVxcXCJyZWFkVmFsdWVcXFwiIHRhYmluZGV4PVxcXCItMVxcXCIgZGF0YS1pZD1cXFwiXCIpLmNvbmNhdChib29rLmlkLCBcIlxcXCIgaWQ9XFxcInJlYWQtXCIpLmNvbmNhdChib29rLmlkLCBcIlxcXCIgYXV0b2NvbXBsZXRlPVxcXCJvZmZcXFwiIFwiKS5jb25jYXQoYm9vay5yZWFkID8gJ2NoZWNrZWQnIDogJycsIFwiIC8+XFxuICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XFxcImNoZWNrbWFya1xcXCIgdGFiaW5kZXg9XFxcIjBcXFwiIGRhdGEtaWQ9XFxcIlwiKS5jb25jYXQoYm9vay5pZCwgXCJcXFwiPjwvc3Bhbj5cXG4gICAgICAgICAgICAgICAgPC9sYWJlbD5cXG4gICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDwvZm9ybT5cXG4gICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICBcIik7XG4gICAgICB9KS5qb2luKCcnKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicmVuZGVyUmVhZGluZ0xpc3RcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyUmVhZGluZ0xpc3QocmVhZGluZ0xpc3REYXRhLCBsb2NhdGlvbikge1xuICAgICAgdmFyIHJlYWRpbmdMaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICByZWFkaW5nTGlzdC5jbGFzc0xpc3QuYWRkKCdyZWFkaW5nLWxpc3QnKTtcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobG9jYXRpb24pLmFwcGVuZENoaWxkKHJlYWRpbmdMaXN0KTtcbiAgICAgIHRoaXMuaW5mb01lc3NhZ2UucmVtb3ZlSW5mb01lc3NhZ2UoJy5yZWFkaW5nLWxpc3QtY29udGVudCcpO1xuICAgICAgaWYgKHJlYWRpbmdMaXN0RGF0YS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgdGhpcy5pbmZvTWVzc2FnZS5yZW5kZXJJbmZvTWVzc2FnZSgnTm8gcmVzdWx0cyBtYXRjaCB5b3VyIHNlYXJjaCBzcGVjaWZpY2F0aW9ucy4nLCAnLnJlYWRpbmctbGlzdC1jb250ZW50Jyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmluZm9NZXNzYWdlLnJlbW92ZUluZm9NZXNzYWdlKCcucmVhZGluZy1saXN0LWNvbnRlbnQnKTtcbiAgICAgICAgdGhpcy5yZW5kZXJCb29rcyhyZWFkaW5nTGlzdERhdGEpO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJyZW1vdmVSZWFkaW5nTGlzdFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVSZWFkaW5nTGlzdChsb2NhdGlvbikge1xuICAgICAgdmFyIHJlYWRpbmdMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIlwiLmNvbmNhdChsb2NhdGlvbiwgXCIgLnJlYWRpbmctbGlzdFwiKSk7XG4gICAgICByZWFkaW5nTGlzdCA/IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobG9jYXRpb24pLnJlbW92ZUNoaWxkKHJlYWRpbmdMaXN0KSA6IG51bGw7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInJlbmRlclJlYWRpbmdMaXN0Q29udGVudFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJSZWFkaW5nTGlzdENvbnRlbnQocmVhZGluZ0xpc3REYXRhLCBsb2NhdGlvbikge1xuICAgICAgdmFyIHJlYWRpbmdMaXN0Q29udGVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgcmVhZGluZ0xpc3RDb250ZW50LmNsYXNzTGlzdC5hZGQoJ2NvbCcsICdyZWFkaW5nLWxpc3QtY29udGVudCcpO1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihsb2NhdGlvbikuYXBwZW5kQ2hpbGQocmVhZGluZ0xpc3RDb250ZW50KTtcbiAgICAgIGlmIChyZWFkaW5nTGlzdERhdGEubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHRoaXMuaW5mb01lc3NhZ2UucmVuZGVySW5mb01lc3NhZ2UoJ1lvdSBjdXJyZW50bHkgaGF2ZSBubyBib29rcyBpbiB5b3VyIHJlYWRpbmcgbGlzdC4gQ2xpY2sgdGhlIEFkZCBCb29rIGJ1dHRvbiB0byBnZXQgc3RhcnRlZC4nLCAnLnJlYWRpbmctbGlzdC1jb250ZW50Jyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmZpbHRlclNvcnRGb3JtLnJlbmRlckZpbHRlclNvcnRGb3JtKCcucmVhZGluZy1saXN0LWNvbnRlbnQnLCB0aGlzLmZpbHRlclNvcnRGb3JtRGF0YSk7XG4gICAgICAgIHRoaXMudXBkYXRlVmlld2FibGVSZWFkaW5nTGlzdCgpO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJyZW1vdmVSZWFkaW5nTGlzdENvbnRlbnRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlUmVhZGluZ0xpc3RDb250ZW50KGxvY2F0aW9uKSB7XG4gICAgICB2YXIgcmVhZGluZ0xpc3RDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIlwiLmNvbmNhdChsb2NhdGlvbiwgXCIgLnJlYWRpbmctbGlzdC1jb250ZW50XCIpKTtcbiAgICAgIHJlYWRpbmdMaXN0Q29udGVudCA/IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobG9jYXRpb24pLnJlbW92ZUNoaWxkKHJlYWRpbmdMaXN0Q29udGVudCkgOiBudWxsO1xuICAgIH1cbiAgfV0pO1xuICByZXR1cm4gUmVhZGluZ0xpc3Q7XG59KCk7XG5leHBvcnQgZGVmYXVsdCBSZWFkaW5nTGlzdDsiLCJmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfVxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cbnZhciBFcnJvck1lc3NhZ2UgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBFcnJvck1lc3NhZ2UoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEVycm9yTWVzc2FnZSk7XG4gIH1cbiAgX2NyZWF0ZUNsYXNzKEVycm9yTWVzc2FnZSwgW3tcbiAgICBrZXk6IFwicmVuZGVyRXJyb3JNZXNzYWdlXCIsXG4gICAgdmFsdWU6XG4gICAgLy8gRE9NIG1ldGhvZHNcbiAgICBmdW5jdGlvbiByZW5kZXJFcnJvck1lc3NhZ2UobWVzc2FnZSwgbG9jYXRpb24pIHtcbiAgICAgIHZhciBlcnJvck1lc3NhZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gICAgICBlcnJvck1lc3NhZ2UuY2xhc3NMaXN0LmFkZCgnbWVzc2FnZScsICdlcnJvci1tZXNzYWdlJyk7XG4gICAgICBlcnJvck1lc3NhZ2UuaW5uZXJIVE1MID0gXCI8c3BhbiBjbGFzcz1cXFwiZmEtc29saWQgZmEtY2lyY2xlLWV4Y2xhbWF0aW9uIGZhLWxnIGZhLWZ3XFxcIiBhcmlhLWhpZGRlbj1cXFwidHJ1ZVxcXCI+PC9zcGFuPiBcIi5jb25jYXQobWVzc2FnZSk7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGxvY2F0aW9uKS5hcHBlbmRDaGlsZChlcnJvck1lc3NhZ2UpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJyZW1vdmVFcnJvck1lc3NhZ2VcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlRXJyb3JNZXNzYWdlKGxvY2F0aW9uKSB7XG4gICAgICB2YXIgZXJyb3JNZXNzYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIlwiLmNvbmNhdChsb2NhdGlvbiwgXCIgLmVycm9yLW1lc3NhZ2VcIikpO1xuICAgICAgZXJyb3JNZXNzYWdlID8gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihsb2NhdGlvbikucmVtb3ZlQ2hpbGQoZXJyb3JNZXNzYWdlKSA6IG51bGw7XG4gICAgfVxuICB9XSk7XG4gIHJldHVybiBFcnJvck1lc3NhZ2U7XG59KCk7XG5leHBvcnQgZGVmYXVsdCBFcnJvck1lc3NhZ2U7IiwiZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cbnZhciBCb29rID0gZnVuY3Rpb24gQm9vayh0aXRsZSwgYXV0aG9yLCBwYWdlcywgcmVhZCwgYm9va0lEKSB7XG4gIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCb29rKTtcbiAgdGhpcy50aXRsZSA9IHRpdGxlO1xuICB0aGlzLmF1dGhvciA9IGF1dGhvcjtcbiAgdGhpcy5wYWdlcyA9IHBhZ2VzO1xuICB0aGlzLnJlYWQgPSByZWFkO1xuICB0aGlzLmlkID0gYm9va0lEO1xufTtcbmV4cG9ydCBkZWZhdWx0IEJvb2s7IiwiZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7IHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7IGlmIChlbnVtZXJhYmxlT25seSkgeyBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgeyByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsgfSk7IH0ga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9XG5mdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSksIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSk7IH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsgfSBlbHNlIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH1cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9XG5mdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7IHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7IH1cbmZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxcbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC5cIik7IH1cbmZ1bmN0aW9uIF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvLCBtaW5MZW4pIHsgaWYgKCFvKSByZXR1cm47IGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IHZhciBuID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pLnNsaWNlKDgsIC0xKTsgaWYgKG4gPT09IFwiT2JqZWN0XCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTsgaWYgKG4gPT09IFwiTWFwXCIgfHwgbiA9PT0gXCJTZXRcIikgcmV0dXJuIEFycmF5LmZyb20obyk7IGlmIChuID09PSBcIkFyZ3VtZW50c1wiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgfVxuZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7IGlmICh0eXBlb2YgU3ltYm9sICE9PSBcInVuZGVmaW5lZFwiICYmIGl0ZXJbU3ltYm9sLml0ZXJhdG9yXSAhPSBudWxsIHx8IGl0ZXJbXCJAQGl0ZXJhdG9yXCJdICE9IG51bGwpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOyB9XG5mdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShhcnIpOyB9XG5mdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikgeyBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkobGVuKTsgaSA8IGxlbjsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH1cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9XG5mdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfVxuaW1wb3J0IEVycm9yTWVzc2FnZSBmcm9tICcuL0Vycm9yTWVzc2FnZSc7XG5pbXBvcnQgQm9vayBmcm9tICcuL0Jvb2snO1xuaW1wb3J0IGdldFJlYWRpbmdMaXN0IGZyb20gJy4uL3V0aWxzL2dldFJlYWRpbmdMaXN0JztcbnZhciBCb29rRm9ybU1vZGFsID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQm9va0Zvcm1Nb2RhbChyZWFkaW5nTGlzdEluc3RhbmNlKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEJvb2tGb3JtTW9kYWwpO1xuICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gbmV3IEVycm9yTWVzc2FnZSgpO1xuICAgIHRoaXMucmVhZGluZ0xpc3QgPSByZWFkaW5nTGlzdEluc3RhbmNlO1xuICAgIHRoaXMuYm9va0Zvcm1UeXBlID0gbnVsbDtcbiAgICB0aGlzLmN1cnJlbnRCb29rSUQgPSBudWxsO1xuICAgIHRoaXMuZm9ybVZhbHVlcyA9IHtcbiAgICAgIHRpdGxlOiAnJyxcbiAgICAgIGF1dGhvcjogJycsXG4gICAgICBwYWdlczogJycsXG4gICAgICByZWFkOiBmYWxzZVxuICAgIH07XG4gIH1cblxuICAvLyBUb2dnbGUgYSBib29rJ3MgUmVhZCBzdGF0dXMgaW4gdGhlIEJvb2sgRm9ybSBNb2RhbCB3aXRoIGtleWJvYXJkXG4gIF9jcmVhdGVDbGFzcyhCb29rRm9ybU1vZGFsLCBbe1xuICAgIGtleTogXCJoYW5kbGVLZXlEb3duXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGhhbmRsZUtleURvd24oZXZlbnQpIHtcbiAgICAgIGlmIChldmVudC5rZXkgPT09ICdFbnRlcicgfHwgZXZlbnQua2V5ID09PSAnICcpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZXZlbnQudGFyZ2V0LmRhdGFzZXQuaW5wdXRJZCkuY2hlY2tlZCA9ICFkb2N1bWVudC5nZXRFbGVtZW50QnlJZChldmVudC50YXJnZXQuZGF0YXNldC5pbnB1dElkKS5jaGVja2VkO1xuICAgICAgICB0aGlzLmZvcm1WYWx1ZXMucmVhZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGV2ZW50LnRhcmdldC5kYXRhc2V0LmlucHV0SWQpLmNoZWNrZWQ7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gU2F2ZSBhIGJvb2sgaW4gZm9ybSBtb2RhbFxuICB9LCB7XG4gICAga2V5OiBcImhhbmRsZVN1Ym1pdFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBoYW5kbGVTdWJtaXQoZXZlbnQsIGZvcm1WYWx1ZXMpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLmVycm9yTWVzc2FnZS5yZW1vdmVFcnJvck1lc3NhZ2UoJyNtb2RhbCAubW9kYWwtYm9keScpO1xuICAgICAgZm9ybVZhbHVlcy50aXRsZSA9IGZvcm1WYWx1ZXMudGl0bGUudHJpbSgpO1xuICAgICAgZm9ybVZhbHVlcy5hdXRob3IgPSBmb3JtVmFsdWVzLmF1dGhvci50cmltKCk7XG4gICAgICBmb3JtVmFsdWVzLnBhZ2VzID0gZm9ybVZhbHVlcy5wYWdlcy50cmltKCk7XG4gICAgICBpZiAoIWZvcm1WYWx1ZXMudGl0bGUpIHtcbiAgICAgICAgdGhpcy5lcnJvck1lc3NhZ2UucmVuZGVyRXJyb3JNZXNzYWdlKCdBIGJvb2sgdGl0bGUgaXMgcmVxdWlyZWQgdG8gYWRkIGEgbmV3IGJvb2suJywgJyNtb2RhbCAubW9kYWwtYm9keScpO1xuICAgICAgfSBlbHNlIGlmICghZm9ybVZhbHVlcy5hdXRob3IpIHtcbiAgICAgICAgdGhpcy5lcnJvck1lc3NhZ2UucmVuZGVyRXJyb3JNZXNzYWdlKCdBbiBhdXRob3IgaXMgcmVxdWlyZWQgdG8gYWRkIGEgbmV3IGJvb2suJywgJyNtb2RhbCAubW9kYWwtYm9keScpO1xuICAgICAgfSBlbHNlIGlmICghZm9ybVZhbHVlcy5wYWdlcykge1xuICAgICAgICB0aGlzLmVycm9yTWVzc2FnZS5yZW5kZXJFcnJvck1lc3NhZ2UoJ1RoZSBudW1iZXIgb2YgcGFnZXMgaXMgcmVxdWlyZWQgdG8gYWRkIGEgbmV3IGJvb2suJywgJyNtb2RhbCAubW9kYWwtYm9keScpO1xuICAgICAgfSBlbHNlIGlmIChpc05hTihmb3JtVmFsdWVzLnBhZ2VzKSB8fCBmb3JtVmFsdWVzLnBhZ2VzIDw9IDApIHtcbiAgICAgICAgdGhpcy5lcnJvck1lc3NhZ2UucmVuZGVyRXJyb3JNZXNzYWdlKCdUaGUgbnVtYmVyIG9mIHBhZ2VzIG11c3QgYmUgYSBudW1iZXIgZ3JlYXRlciB0aGFuIDAuJywgJyNtb2RhbCAubW9kYWwtYm9keScpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHRoaXMuYm9va0Zvcm1UeXBlID09PSAnZWRpdCcpIHtcbiAgICAgICAgICB0aGlzLmVkaXRCb29rKGZvcm1WYWx1ZXMsIF90b0NvbnN1bWFibGVBcnJheShnZXRSZWFkaW5nTGlzdCgpKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5hZGROZXdCb29rKGZvcm1WYWx1ZXMsIF90b0NvbnN1bWFibGVBcnJheShnZXRSZWFkaW5nTGlzdCgpKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jbG9zZU1vZGFsKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQWRkIGEgbmV3IGJvb2sgdG8gdGhlIHJlYWRpbmcgbGlzdFxuICB9LCB7XG4gICAga2V5OiBcImFkZE5ld0Jvb2tcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkTmV3Qm9vayhmb3JtVmFsdWVzLCByZWFkaW5nTGlzdERhdGEpIHtcbiAgICAgIHZhciBuZXdCb29rID0gbmV3IEJvb2soZm9ybVZhbHVlcy50aXRsZSwgZm9ybVZhbHVlcy5hdXRob3IsIGZvcm1WYWx1ZXMucGFnZXMsIGZvcm1WYWx1ZXMucmVhZCwgRGF0ZS5ub3coKSk7XG4gICAgICB0aGlzLnJlYWRpbmdMaXN0LmFkZE5ld0Jvb2sobmV3Qm9vaywgcmVhZGluZ0xpc3REYXRhKTtcbiAgICB9XG5cbiAgICAvLyBFZGl0IGEgYm9vayBpbiB0aGUgcmVhZGluZyBsaXN0XG4gIH0sIHtcbiAgICBrZXk6IFwiZWRpdEJvb2tcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZWRpdEJvb2soZm9ybVZhbHVlcywgcmVhZGluZ0xpc3REYXRhKSB7XG4gICAgICB0aGlzLnJlYWRpbmdMaXN0LmVkaXRCb29rKGZvcm1WYWx1ZXMsIHRoaXMuY3VycmVudEJvb2tJRCwgcmVhZGluZ0xpc3REYXRhKTtcbiAgICB9XG5cbiAgICAvLyBPcGVuIGJvb2sgZm9ybSBtb2RhbFxuICB9LCB7XG4gICAga2V5OiBcIm9wZW5Nb2RhbFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuTW9kYWwoYm9va0Zvcm1UeXBlKSB7XG4gICAgICB2YXIgcmVhZGluZ0xpc3REYXRhID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBudWxsO1xuICAgICAgdmFyIGJvb2tJRCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogbnVsbDtcbiAgICAgIHZhciBib29rVG9CZUVkaXRlZDtcbiAgICAgIHZhciBmb3JtRGF0YTtcbiAgICAgIGlmIChib29rRm9ybVR5cGUgPT09ICdlZGl0Jykge1xuICAgICAgICB0aGlzLmJvb2tGb3JtVHlwZSA9ICdlZGl0JztcbiAgICAgICAgdGhpcy5jdXJyZW50Qm9va0lEID0gYm9va0lEO1xuICAgICAgICBib29rVG9CZUVkaXRlZCA9IHJlYWRpbmdMaXN0RGF0YS5maW5kKGZ1bmN0aW9uIChib29rKSB7XG4gICAgICAgICAgcmV0dXJuIGJvb2suaWQgPT09IE51bWJlcihib29rSUQpO1xuICAgICAgICB9KTtcbiAgICAgICAgZm9ybURhdGEgPSB7XG4gICAgICAgICAgdGl0bGU6IGJvb2tUb0JlRWRpdGVkLnRpdGxlLFxuICAgICAgICAgIGF1dGhvcjogYm9va1RvQmVFZGl0ZWQuYXV0aG9yLFxuICAgICAgICAgIHBhZ2VzOiBib29rVG9CZUVkaXRlZC5wYWdlcyxcbiAgICAgICAgICByZWFkOiBib29rVG9CZUVkaXRlZC5yZWFkXG4gICAgICAgIH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmJvb2tGb3JtVHlwZSA9ICdhZGQnO1xuICAgICAgICBmb3JtRGF0YSA9IHRoaXMuZm9ybVZhbHVlcztcbiAgICAgIH1cbiAgICAgIHRoaXMucmVuZGVyQm9va0Zvcm1Nb2RhbCgnbWFpbicsIGZvcm1EYXRhKTtcbiAgICB9XG5cbiAgICAvLyBDbG9zZSBib29rIGZvcm0gbW9kYWxcbiAgfSwge1xuICAgIGtleTogXCJjbG9zZU1vZGFsXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNsb3NlTW9kYWwoKSB7XG4gICAgICB0aGlzLnJlbW92ZUJvb2tGb3JtTW9kYWwoJ21haW4nKTtcbiAgICAgIHRoaXMuZm9ybVZhbHVlcyA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgdGhpcy5mb3JtVmFsdWVzKSwge30sIHtcbiAgICAgICAgdGl0bGU6ICcnLFxuICAgICAgICBhdXRob3I6ICcnLFxuICAgICAgICBwYWdlczogJycsXG4gICAgICAgIHJlYWQ6IGZhbHNlXG4gICAgICB9KTtcbiAgICAgIHRoaXMuY3VycmVudEJvb2tJRCA9IG51bGw7XG4gICAgfVxuXG4gICAgLy8gRE9NIG1ldGhvZHNcbiAgfSwge1xuICAgIGtleTogXCJyZW5kZXJCb29rRm9ybU1vZGFsXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlckJvb2tGb3JtTW9kYWwobG9jYXRpb24sIGZvcm1EYXRhKSB7XG4gICAgICB2YXIgYm9va0Zvcm1Nb2RhbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgYm9va0Zvcm1Nb2RhbC5zZXRBdHRyaWJ1dGUoJ2lkJywgJ21vZGFsJyk7XG4gICAgICBib29rRm9ybU1vZGFsLmNsYXNzTGlzdC5hZGQoJ21vZGFsJyk7XG4gICAgICBib29rRm9ybU1vZGFsLmlubmVySFRNTCA9IFwiXFxuICAgICAgPGRpdiBjbGFzcz1cXFwibW9kYWwtY29udGVudFxcXCI+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJtb2RhbC1oZWFkZXJcXFwiPlwiLmNvbmNhdCh0aGlzLmJvb2tGb3JtVHlwZSA9PT0gJ2VkaXQnID8gJ0VkaXQnIDogJ0FkZCBOZXcnLCBcIiBCb29rPC9kaXY+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJtb2RhbC1ib2R5XFxcIj5cXG4gICAgICAgICAgPGZvcm0gY2xhc3M9XFxcIm5ldy1ib29rLWZvcm1cXFwiIG5vdmFsaWRhdGU+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ncm91cFxcXCI+XFxuICAgICAgICAgICAgICA8bGFiZWwgZm9yPVxcXCJ0aXRsZS12YWx1ZVxcXCI+VGl0bGU8L2xhYmVsPlxcbiAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XFxcInRleHRcXFwiIGNsYXNzPVxcXCJ0aXRsZS12YWx1ZVxcXCIgbmFtZT1cXFwidGl0bGVcXFwiIHZhbHVlPVxcXCJcIikuY29uY2F0KGZvcm1EYXRhLnRpdGxlLCBcIlxcXCIgaWQ9XFxcInRpdGxlLXZhbHVlXFxcIiBhdXRvY29tcGxldGU9XFxcIm9mZlxcXCIgcmVxdWlyZWQgLz5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWdyb3VwXFxcIj5cXG4gICAgICAgICAgICAgIDxsYWJlbCBmb3I9XFxcImF1dGhvci12YWx1ZVxcXCI+QXV0aG9yPC9sYWJlbD5cXG4gICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVxcXCJ0ZXh0XFxcIiBjbGFzcz1cXFwiYXV0aG9yLXZhbHVlXFxcIiBuYW1lPVxcXCJhdXRob3JcXFwiIHZhbHVlPVxcXCJcIikuY29uY2F0KGZvcm1EYXRhLmF1dGhvciwgXCJcXFwiIGlkPVxcXCJhdXRob3ItdmFsdWVcXFwiIGF1dG9jb21wbGV0ZT1cXFwib2ZmXFxcIiByZXF1aXJlZCAvPlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImZvcm0tZ3JvdXBcXFwiPlxcbiAgICAgICAgICAgICAgPGxhYmVsIGZvcj1cXFwicGFnZXMtdmFsdWVcXFwiPk51bWJlciBvZiBQYWdlczwvbGFiZWw+XFxuICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cXFwidGV4dFxcXCIgY2xhc3M9XFxcInBhZ2VzLXZhbHVlXFxcIiBuYW1lPVxcXCJwYWdlc1xcXCIgaW5wdXRtb2RlPVxcXCJudW1lcmljXFxcIiB2YWx1ZT1cXFwiXCIpLmNvbmNhdChmb3JtRGF0YS5wYWdlcywgXCJcXFwiIGlkPVxcXCJwYWdlcy12YWx1ZVxcXCIgYXV0b2NvbXBsZXRlPVxcXCJvZmZcXFwiIHJlcXVpcmVkIC8+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ncm91cFxcXCI+XFxuICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9XFxcImNoZWNrLWxhYmVsXFxcIiBmb3I9XFxcInJlYWQtdmFsdWVcXFwiPlJlYWRcXG4gICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XFxcImNoZWNrYm94XFxcIiBuYW1lPVxcXCJyZWFkXFxcIiB0YWJpbmRleD1cXFwiLTFcXFwiIGlkPVxcXCJyZWFkLXZhbHVlXFxcIiBcIikuY29uY2F0KGZvcm1EYXRhLnJlYWQgPyAnY2hlY2tlZCcgOiAnJywgXCIgYXV0b2NvbXBsZXRlPVxcXCJvZmZcXFwiIC8+XFxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVxcXCJjaGVja21hcmtcXFwiIHRhYmluZGV4PVxcXCIwXFxcIiBkYXRhLWlucHV0LWlkPVxcXCJyZWFkLXZhbHVlXFxcIj48L3NwYW4+XFxuICAgICAgICAgICAgICA8L2xhYmVsPlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImJ1dHRvbi1ncm91cFxcXCI+XFxuICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9XFxcInN1Ym1pdFxcXCIgY2xhc3M9XFxcImJ1dHRvbiBtb2RhbC1idXR0b25cXFwiPlNhdmU8L2J1dHRvbj5cXG4gICAgICAgICAgICAgIDxidXR0b24gdHlwZT1cXFwiYnV0dG9uXFxcIiBjbGFzcz1cXFwiYnV0dG9uIG1vZGFsLWJ1dHRvbiBjYW5jZWxcXFwiPkNhbmNlbDwvYnV0dG9uPlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICA8L2Zvcm0+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICA8L2Rpdj5cXG4gICAgXCIpO1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihsb2NhdGlvbikuYXBwZW5kQ2hpbGQoYm9va0Zvcm1Nb2RhbCk7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5JykuY2xhc3NMaXN0LmFkZCgnbW9kYWwtb3BlbicpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJyZW1vdmVCb29rRm9ybU1vZGFsXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZUJvb2tGb3JtTW9kYWwobG9jYXRpb24pIHtcbiAgICAgIHZhciBib29rRm9ybU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIlwiLmNvbmNhdChsb2NhdGlvbiwgXCIgI21vZGFsXCIpKTtcbiAgICAgIGJvb2tGb3JtTW9kYWwgPyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGxvY2F0aW9uKS5yZW1vdmVDaGlsZChib29rRm9ybU1vZGFsKSA6IG51bGw7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5JykuY2xhc3NMaXN0LnJlbW92ZSgnbW9kYWwtb3BlbicpO1xuICAgIH1cbiAgfV0pO1xuICByZXR1cm4gQm9va0Zvcm1Nb2RhbDtcbn0oKTtcbmV4cG9ydCBkZWZhdWx0IEJvb2tGb3JtTW9kYWw7IiwiZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgeyByZXR1cm4gX2FycmF5V2l0aG91dEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF9ub25JdGVyYWJsZVNwcmVhZCgpOyB9XG5mdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuXCIpOyB9XG5mdW5jdGlvbiBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobywgbWluTGVuKSB7IGlmICghbykgcmV0dXJuOyBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB2YXIgbiA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKS5zbGljZSg4LCAtMSk7IGlmIChuID09PSBcIk9iamVjdFwiICYmIG8uY29uc3RydWN0b3IpIG4gPSBvLmNvbnN0cnVjdG9yLm5hbWU7IGlmIChuID09PSBcIk1hcFwiIHx8IG4gPT09IFwiU2V0XCIpIHJldHVybiBBcnJheS5mcm9tKG8pOyBpZiAobiA9PT0gXCJBcmd1bWVudHNcIiB8fCAvXig/OlVpfEkpbnQoPzo4fDE2fDMyKSg/OkNsYW1wZWQpP0FycmF5JC8udGVzdChuKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IH1cbmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgeyBpZiAodHlwZW9mIFN5bWJvbCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBpdGVyW1N5bWJvbC5pdGVyYXRvcl0gIT0gbnVsbCB8fCBpdGVyW1wiQEBpdGVyYXRvclwiXSAhPSBudWxsKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTsgfVxuZnVuY3Rpb24gX2FycmF5V2l0aG91dEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkoYXJyKTsgfVxuZnVuY3Rpb24gX2FycmF5TGlrZVRvQXJyYXkoYXJyLCBsZW4pIHsgaWYgKGxlbiA9PSBudWxsIHx8IGxlbiA+IGFyci5sZW5ndGgpIGxlbiA9IGFyci5sZW5ndGg7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKykgeyBhcnIyW2ldID0gYXJyW2ldOyB9IHJldHVybiBhcnIyOyB9XG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfVxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cbmltcG9ydCBIZWFkZXIgZnJvbSAnLi9tb2R1bGVzL0hlYWRlcic7XG5pbXBvcnQgRm9vdGVyIGZyb20gJy4vbW9kdWxlcy9Gb290ZXInO1xuaW1wb3J0IFNpZGViYXIgZnJvbSAnLi9tb2R1bGVzL1NpZGViYXInO1xuaW1wb3J0IFJlYWRpbmdMaXN0IGZyb20gJy4vbW9kdWxlcy9SZWFkaW5nTGlzdCc7XG5pbXBvcnQgQm9va0Zvcm1Nb2RhbCBmcm9tICcuL21vZHVsZXMvQm9va0Zvcm1Nb2RhbCc7XG5pbXBvcnQgZ2V0UmVhZGluZ0xpc3QgZnJvbSAnLi91dGlscy9nZXRSZWFkaW5nTGlzdCc7XG52YXIgQXBwID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQXBwKCkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBBcHApO1xuICAgIHRoaXMuaGVhZGVyID0gbmV3IEhlYWRlcigpO1xuICAgIHRoaXMuZm9vdGVyID0gbmV3IEZvb3RlcigpO1xuICAgIHRoaXMuc2lkZWJhciA9IG5ldyBTaWRlYmFyKCk7XG4gICAgdGhpcy5yZWFkaW5nTGlzdCA9IG5ldyBSZWFkaW5nTGlzdCh0aGlzLnNpZGViYXIpO1xuICAgIHRoaXMuYm9va0Zvcm1Nb2RhbCA9IG5ldyBCb29rRm9ybU1vZGFsKHRoaXMucmVhZGluZ0xpc3QpO1xuICAgIHRoaXMucmVuZGVyQXBwKCk7XG4gIH1cblxuICAvLyBFdmVudCBsaXN0ZW5lcnNcbiAgX2NyZWF0ZUNsYXNzKEFwcCwgW3tcbiAgICBrZXk6IFwiZXZlbnRzXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGV2ZW50cygpIHtcbiAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB2YXIgZWxlbWVudCA9IGV2ZW50LnRhcmdldDtcbiAgICAgICAgZWxlbWVudC5tYXRjaGVzKCcjbW9kYWwgLm1vZGFsLWJ1dHRvbi5jYW5jZWwnKSA/IF90aGlzLmJvb2tGb3JtTW9kYWwuY2xvc2VNb2RhbCgpIDogbnVsbDtcbiAgICAgICAgZWxlbWVudC5tYXRjaGVzKCcjbW9kYWwnKSA/IF90aGlzLmJvb2tGb3JtTW9kYWwuY2xvc2VNb2RhbCgpIDogbnVsbDtcbiAgICAgICAgZWxlbWVudC5tYXRjaGVzKCcuYm9vay1jYXJkIC5kZWxldGUtYm9vay1idXR0b24nKSA/IF90aGlzLnJlYWRpbmdMaXN0LmRlbGV0ZUJvb2soX3RvQ29uc3VtYWJsZUFycmF5KGdldFJlYWRpbmdMaXN0KCkpLCBlbGVtZW50LmRhdGFzZXQuaWQpIDogbnVsbDtcbiAgICAgICAgZWxlbWVudC5tYXRjaGVzKCcuYm9vay1jYXJkIC5jaGVjay1sYWJlbCBpbnB1dFt0eXBlPWNoZWNrYm94XScpID8gX3RoaXMucmVhZGluZ0xpc3QudG9nZ2xlUmVhZChldmVudCwgZWxlbWVudC5kYXRhc2V0LmlkLCBfdG9Db25zdW1hYmxlQXJyYXkoZ2V0UmVhZGluZ0xpc3QoKSkpIDogbnVsbDtcbiAgICAgICAgZWxlbWVudC5tYXRjaGVzKCcuc2lkZWJhciAuYWRkLWJvb2stYnV0dG9uJykgPyBfdGhpcy5ib29rRm9ybU1vZGFsLm9wZW5Nb2RhbCgnYWRkJykgOiBudWxsO1xuICAgICAgICBlbGVtZW50Lm1hdGNoZXMoJy5ib29rLWNhcmQgLmVkaXQtYm9vay1idXR0b24nKSA/IF90aGlzLmJvb2tGb3JtTW9kYWwub3Blbk1vZGFsKCdlZGl0JywgX3RvQ29uc3VtYWJsZUFycmF5KGdldFJlYWRpbmdMaXN0KCkpLCBlbGVtZW50LmRhdGFzZXQuaWQpIDogbnVsbDtcbiAgICAgIH0pO1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHZhciBlbGVtZW50ID0gZXZlbnQudGFyZ2V0O1xuICAgICAgICBlbGVtZW50Lm1hdGNoZXMoJy5maWx0ZXItc29ydC1mb3JtICNmaWx0ZXItcmVhZC12YWx1ZScpID8gX3RoaXMucmVhZGluZ0xpc3QuaGFuZGxlQ2hhbmdlKGV2ZW50KSA6IG51bGw7XG4gICAgICAgIGVsZW1lbnQubWF0Y2hlcygnLmZpbHRlci1zb3J0LWZvcm0gI3NvcnQtdmFsdWUnKSA/IF90aGlzLnJlYWRpbmdMaXN0LmhhbmRsZUNoYW5nZShldmVudCkgOiBudWxsO1xuICAgICAgfSk7XG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdmFyIGVsZW1lbnQgPSBldmVudC50YXJnZXQ7XG4gICAgICAgIGVsZW1lbnQubWF0Y2hlcygnI21vZGFsIC5uZXctYm9vay1mb3JtJykgPyBfdGhpcy5ib29rRm9ybU1vZGFsLmhhbmRsZVN1Ym1pdChldmVudCwge1xuICAgICAgICAgIHRpdGxlOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGl0bGUtdmFsdWUnKS52YWx1ZSxcbiAgICAgICAgICBhdXRob3I6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhdXRob3ItdmFsdWUnKS52YWx1ZSxcbiAgICAgICAgICBwYWdlczogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhZ2VzLXZhbHVlJykudmFsdWUsXG4gICAgICAgICAgcmVhZDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlYWQtdmFsdWUnKS5jaGVja2VkXG4gICAgICAgIH0pIDogbnVsbDtcbiAgICAgICAgZWxlbWVudC5tYXRjaGVzKCcuZmlsdGVyLXNvcnQtZm9ybScpID8gZXZlbnQucHJldmVudERlZmF1bHQoKSA6IG51bGw7XG4gICAgICB9KTtcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdmFyIGVsZW1lbnQgPSBldmVudC50YXJnZXQ7XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtb2RhbCcpICYmIGV2ZW50LmtleSA9PT0gJ0VzY2FwZScgPyBfdGhpcy5ib29rRm9ybU1vZGFsLmNsb3NlTW9kYWwoKSA6IG51bGw7XG4gICAgICAgIGVsZW1lbnQubWF0Y2hlcygnI21vZGFsIC5uZXctYm9vay1mb3JtIC5jaGVja21hcmsnKSA/IF90aGlzLmJvb2tGb3JtTW9kYWwuaGFuZGxlS2V5RG93bihldmVudCkgOiBudWxsO1xuICAgICAgICBlbGVtZW50Lm1hdGNoZXMoJy5ib29rLWNhcmQgLmNoZWNrbWFyaycpID8gX3RoaXMucmVhZGluZ0xpc3QudG9nZ2xlUmVhZChldmVudCwgZWxlbWVudC5kYXRhc2V0LmlkLCBfdG9Db25zdW1hYmxlQXJyYXkoZ2V0UmVhZGluZ0xpc3QoKSkpIDogbnVsbDtcbiAgICAgIH0pO1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdmFyIGVsZW1lbnQgPSBldmVudC50YXJnZXQ7XG4gICAgICAgIGVsZW1lbnQubWF0Y2hlcygnLmZpbHRlci1zb3J0LWZvcm0gI3NlYXJjaC12YWx1ZScpID8gX3RoaXMucmVhZGluZ0xpc3QuaGFuZGxlQ2hhbmdlKGV2ZW50KSA6IG51bGw7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBET00gbWV0aG9kc1xuICB9LCB7XG4gICAga2V5OiBcInJlbmRlckFwcFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJBcHAoKSB7XG4gICAgICB0aGlzLmhlYWRlci5yZW5kZXJIZWFkZXIoJyNhcHAnKTtcbiAgICAgIHRoaXMucmVuZGVyTWFpbignI2FwcCcpO1xuICAgICAgdGhpcy5mb290ZXIucmVuZGVyRm9vdGVyKCcjYXBwJyk7XG4gICAgICB0aGlzLnNpZGViYXIucmVuZGVyU2lkZWJhcignLnJlYWRpbmctbGlzdC1jb250YWluZXInKTtcbiAgICAgIHRoaXMucmVhZGluZ0xpc3QucmVuZGVyUmVhZGluZ0xpc3RDb250ZW50KF90b0NvbnN1bWFibGVBcnJheShnZXRSZWFkaW5nTGlzdCgpKSwgJy5yZWFkaW5nLWxpc3QtY29udGFpbmVyJyk7XG4gICAgICB0aGlzLmV2ZW50cygpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJyZW5kZXJNYWluXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlck1haW4obG9jYXRpb24pIHtcbiAgICAgIHZhciBtYWluID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbWFpbicpO1xuICAgICAgbWFpbi5pbm5lckhUTUwgPSBcIjxkaXYgY2xhc3M9XFxcInJlYWRpbmctbGlzdC1jb250YWluZXJcXFwiPjwvZGl2PlwiO1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihsb2NhdGlvbikuYXBwZW5kQ2hpbGQobWFpbik7XG4gICAgfVxuICB9XSk7XG4gIHJldHVybiBBcHA7XG59KCk7XG5leHBvcnQgZGVmYXVsdCBBcHA7IiwiZXhwb3J0IGRlZmF1bHQgX193ZWJwYWNrX3B1YmxpY19wYXRoX18gKyBcImluZGV4Lmh0bWxcIjsiLCJleHBvcnQgZGVmYXVsdCBfX3dlYnBhY2tfcHVibGljX3BhdGhfXyArIFwiZmF2aWNvbi5pY29cIjsiLCJpbXBvcnQgQXBwIGZyb20gJy4vQXBwJztcbmltcG9ydCAnZmlsZS1sb2FkZXI/bmFtZT1bbmFtZV0uW2V4dF0hLi9pbmRleC5odG1sJztcbmltcG9ydCAnZmlsZS1sb2FkZXI/bmFtZT1bbmFtZV0uW2V4dF0hLi9mYXZpY29uLmljbyc7XG5pbXBvcnQgJ25vcm1hbGl6ZS5jc3MnO1xuaW1wb3J0ICdAZm9ydGF3ZXNvbWUvZm9udGF3ZXNvbWUtZnJlZS9jc3MvYWxsLm1pbi5jc3MnO1xuaW1wb3J0ICcuL3N0eWxlc2hlZXRzL3N0eWxlLnNjc3MnO1xubmV3IEFwcCgpOyJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///580\n')}},__webpack_require__={};__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var e;__webpack_require__.g.importScripts&&(e=__webpack_require__.g.location+"");var c=__webpack_require__.g.document;if(!e&&c&&(c.currentScript&&"SCRIPT"===c.currentScript.tagName.toUpperCase()&&(e=c.currentScript.src),!e)){var n=c.getElementsByTagName("script");if(n.length)for(var t=n.length-1;t>-1&&(!e||!/^http(s?):/.test(e));)e=n[t--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),__webpack_require__.p=e})();var __webpack_exports__={};__webpack_modules__[580](0,__webpack_exports__,__webpack_require__)})();